<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BitX äº¤æ˜“åŸå‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #0a0b0d;
            color: #ffffff;
            overflow-x: hidden;
        }

        /* å·¦å´å°èˆªæ¬„ */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 240px;
            height: 100vh;
            background: #111218;
            border-right: 1px solid #1f2937;
            z-index: 100;
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid #1f2937;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #3b82f6;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo::before {
            content: "âš¡";
            font-size: 1.2rem;
        }

        .sidebar-nav {
            flex: 1;
            padding: 1rem 0;
        }

        .nav-item {
            display: block;
            padding: 0.875rem 1.5rem;
            color: #9ca3af;
            text-decoration: none;
            transition: all 0.2s;
            border-left: 3px solid transparent;
            font-weight: 500;
        }

        .nav-item:hover {
            background: #1f2937;
            color: #ffffff;
            border-left-color: #3b82f6;
        }

        .nav-item.active {
            background: #1e40af;
            color: #ffffff;
            border-left-color: #3b82f6;
        }

        .nav-icon {
            display: inline-block;
            width: 20px;
            margin-right: 0.75rem;
        }

        /* ä¸»å†…å®¹åŒºåŸŸ */
        .main-layout {
            margin-left: 240px;
            min-height: 100vh;
            display: flex;
        }

        .content-area {
            flex: 1;
            padding: 2rem;
            max-width: calc(100vw - 240px - 420px);
        }

        /* å‰µå»ºé é¢ç‰¹æ®Šä½ˆå±€ */
        #create .content-area {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 3rem;
        }

        .container {
            max-width: none;
            margin: 0;
            padding: 0;
        }

        /* å³å´äº¤æ˜“æ¬„ */
        .trading-sidebar {
            width: 420px;
            background: #111218;
            border-left: 1px solid #1f2937;
            padding: 2rem;
            overflow-y: auto;
            position: fixed;
            right: 0;
            top: 0;
            height: 100vh;
            z-index: 50;
        }

        .trading-sidebar.hidden {
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .trading-header {
            padding-bottom: 1rem;
            border-bottom: 1px solid #1f2937;
            margin-bottom: 1.5rem;
        }

        .trading-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 0.5rem;
        }

        .trading-subtitle {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border: 1px solid #3b82f6;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .btn-secondary {
            background: #1f2937;
            color: #d1d5db;
            border: 1px solid #374151;
        }

        .btn-secondary:hover {
            background: #374151;
            color: #ffffff;
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: 1px solid #10b981;
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #059669, #047857);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            border: 1px solid #ef4444;
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid;
        }

        .btn-outline.btn-success {
            border-color: #16a34a;
            color: #16a34a;
        }

        .btn-outline.btn-success:hover {
            background: rgba(22, 163, 74, 0.1);
        }

        .btn-outline.btn-danger {
            border-color: #dc2626;
            color: #dc2626;
        }

        .btn-outline.btn-danger:hover {
            background: rgba(220, 38, 38, 0.1);
        }

        /* é¡µé¢åˆ‡æ¢ */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* é¦–é ç€‘å¸ƒæµ */
        .waterfall {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 1.5rem;
        }

        .topic-card {
            background: #1a1b23;
            border: 1px solid #2d3748;
            border-radius: 16px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .topic-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #10b981);
        }

        .topic-card:hover {
            transform: translateY(-4px);
            border-color: #3b82f6;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        .topic-progress {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #374151;
        }

        .topic-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .topic-avatar {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: linear-gradient(135deg, #3b82f6, #10b981);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .topic-info h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: #ffffff;
            line-height: 1.4;
        }

        .topic-category {
            background: rgba(59, 130, 246, 0.1);
            color: #60a5fa;
            padding: 0.3rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .topic-stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1rem;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid #2d3748;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: #3b82f6;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.75rem;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* å‰µå»ºè©±é¡Œé é¢ */
        .create-form {
            max-width: 700px;
            margin: 0 auto;
            background: #1a1b23;
            border: 1px solid #2d3748;
            border-radius: 16px;
            padding: 2.5rem;
        }

        .form-group {
            margin-bottom: 2rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.75rem;
            font-weight: 600;
            color: #ffffff;
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 1rem;
            border: 1px solid #374151;
            border-radius: 8px;
            font-size: 1rem;
            background: #111218;
            color: #ffffff;
            transition: all 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            background: #1a1b23;
        }

        .form-input::placeholder {
            color: #6b7280;
        }

        .form-textarea {
            resize: vertical;
            min-height: 120px;
            line-height: 1.6;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #3b82f6;
        }

        .pump-notice {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: 8px;
            padding: 1.25rem;
            margin: 1.5rem 0;
            color: #fbbf24;
        }

        .pump-notice strong {
            color: #f59e0b;
        }

        .options-container {
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .option-input {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .add-option {
            color: #2563eb;
            cursor: pointer;
            font-size: 0.9rem;
        }

        /* è©±é¡Œè©³æƒ…é é¢ */
        .topic-detail-container {
            background: #1a1b23;
            border: 1px solid #2d3748;
            border-radius: 16px;
            padding: 2.5rem;
            margin-bottom: 2rem;
        }

        .main-content {
            width: 100%;
        }

        .topic-title {
            font-size: 1.75rem;
            margin-bottom: 1rem;
            color: #ffffff;
            font-weight: 700;
            line-height: 1.3;
        }

        .topic-meta {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 2rem;
            font-size: 0.875rem;
            color: #9ca3af;
            align-items: center;
        }

        /* äº¤æ˜“ç•Œé¢æ ·å¼ */
        .betting-interface {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .bet-option {
            border: 2px solid #374151;
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #111218;
            position: relative;
            overflow: hidden;
        }

        .bet-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .bet-option:hover {
            transform: translateY(-2px);
            border-color: #4b5563;
        }

        .bet-option.selected {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.05);
        }

        .bet-option.yes {
            border-color: #059669;
        }

        .bet-option.yes.selected {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.05);
        }

        .bet-option.yes::before {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), transparent);
        }

        .bet-option.no {
            border-color: #dc2626;
        }

        .bet-option.no.selected {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.05);
        }

        .bet-option.no::before {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), transparent);
        }

        .bet-option.selected::before {
            opacity: 1;
        }

        .bet-label {
            font-weight: 700;
            font-size: 1.25rem;
            margin-bottom: 0.75rem;
            position: relative;
            z-index: 1;
        }

        .bet-option.yes .bet-label {
            color: #10b981;
        }

        .bet-option.no .bet-label {
            color: #ef4444;
        }

        .bet-amount {
            color: #9ca3af;
            font-size: 0.9rem;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }

        .amount-input-group {
            display: flex;
            gap: 0.75rem;
            margin: 2rem 0;
        }

        .amount-input {
            flex: 1;
            padding: 1rem;
            border: 1px solid #374151;
            border-radius: 8px;
            background: #111218;
            color: #ffffff;
            font-size: 1rem;
        }

        .amount-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .amount-input::placeholder {
            color: #6b7280;
        }

        /* å³ä¾§äº¤æ˜“æ å†…å®¹æ ·å¼ */
        .trading-section {
            margin-bottom: 2rem;
        }

        .section-title {
            font-weight: 600;
            margin-bottom: 1rem;
            color: #ffffff;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-title::before {
            content: '';
            width: 3px;
            height: 16px;
            background: linear-gradient(135deg, #3b82f6, #10b981);
            border-radius: 2px;
        }

        .pool-info {
            background: rgba(31, 41, 55, 0.5);
            border: 1px solid #374151;
            border-radius: 12px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
        }

        .pool-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .pool-row:last-child {
            margin-bottom: 0;
            font-weight: 700;
            padding-top: 1rem;
            border-top: 1px solid #374151;
            font-size: 1rem;
        }

        .pool-label {
            color: #9ca3af;
        }

        .pool-value {
            color: #ffffff;
            font-weight: 600;
        }

        .pool-row:last-child .pool-value {
            color: #3b82f6;
        }

        .pump-progress {
            margin: 1.5rem 0;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: rgba(55, 65, 81, 0.5);
            border-radius: 6px;
            overflow: hidden;
            border: 1px solid #374151;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #3b82f6);
            transition: width 0.5s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            text-align: center;
            margin-top: 0.75rem;
            font-size: 0.875rem;
            color: #9ca3af;
            font-weight: 500;
        }

        .progress-text strong {
            color: #10b981;
        }

        /* LMSRåƒ¹æ ¼å¡ç‰‡æ ·å¼ */
        .price-card {
            background: rgba(31, 41, 55, 0.5);
            border: 1px solid #374151;
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .price-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
        }

        .price-card.yes-price::before {
            background: linear-gradient(90deg, #10b981, #059669);
        }

        .price-card.no-price::before {
            background: linear-gradient(90deg, #ef4444, #dc2626);
        }

        .price-label {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
            opacity: 0.8;
        }

        .yes-price .price-label {
            color: #34d399;
        }

        .no-price .price-label {
            color: #f87171;
        }

        .price-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 0.25rem;
        }

        .price-unit {
            font-size: 0.75rem;
            color: #9ca3af;
            opacity: 0.8;
        }

        /* LMSRäº¤æ˜“æŒ‰é’®æ ·å¼ */
        .lmsr-buy-btn {
            position: relative;
            overflow: hidden;
        }

        .lmsr-buy-btn small {
            margin-top: 0.25rem;
        }

        .trading-form {
            margin-top: 1rem;
        }

        /* èµ„é‡‘æ± åˆ†åŒºæ ·å¼ */
        .pool-section {
            margin-bottom: 1.5rem;
        }

        .pool-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #374151;
        }

        .pool-section-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #ffffff;
        }

        .pool-section-badge {
            font-size: 0.7rem;
            padding: 0.25rem 0.6rem;
            border-radius: 12px;
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.05em;
        }

        .pool-section-badge:not(.outer) {
            background: rgba(59, 130, 246, 0.1);
            color: #60a5fa;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .pool-section-badge.outer {
            background: rgba(16, 185, 129, 0.1);
            color: #34d399;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .pool-section-badge.pumped {
            background: rgba(245, 158, 11, 0.1);
            color: #fbbf24;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.4rem 0.9rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .status-inner {
            background: rgba(59, 130, 246, 0.1);
            color: #60a5fa;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .status-outer {
            background: rgba(16, 185, 129, 0.1);
            color: #34d399;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .status-ended {
            background: rgba(239, 68, 68, 0.1);
            color: #f87171;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        /* å€‹äººä¸­å¿ƒæ¨£å¼ */
        .profile-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: #1a1b23;
            border: 1px solid #2d3748;
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
        }

        .stat-card h3 {
            color: #9ca3af;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .stat-card .value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .stat-card.positive .value {
            color: #10b981;
        }

        .stat-card.primary .value {
            color: #3b82f6;
        }

        /* æŒä»“å’Œäº¤æ˜“æ­·å²æ ·å¼ */
        .position-item, .history-item {
            background: rgba(31, 41, 55, 0.5);
            border: 1px solid #374151;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .position-info, .history-info {
            flex: 1;
        }

        .position-title, .history-title {
            color: #ffffff;
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .position-details, .history-details {
            color: #9ca3af;
            font-size: 0.85rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .position-value, .history-value {
            text-align: right;
        }

        .position-amount, .history-amount {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .position-amount.positive, .history-amount.positive {
            color: #10b981;
        }

        .position-amount.negative, .history-amount.negative {
            color: #ef4444;
        }

        .position-amount.neutral, .history-amount.neutral {
            color: #60a5fa;
        }

        .position-status, .history-status {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .status-active {
            background: rgba(59, 130, 246, 0.1);
            color: #60a5fa;
        }

        .status-won {
            background: rgba(16, 185, 129, 0.1);
            color: #34d399;
        }

        .status-lost {
            background: rgba(239, 68, 68, 0.1);
            color: #f87171;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: #6b7280;
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1024px) {
            .main-layout {
                margin-left: 0;
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                order: -1;
                flex-direction: row;
                border-right: none;
                border-bottom: 1px solid #1f2937;
            }
            
            .sidebar-nav {
                display: flex;
                flex-direction: row;
                padding: 0;
            }
            
            .nav-item {
                flex: 1;
                text-align: center;
                border-left: none;
                border-bottom: 3px solid transparent;
            }
            
            .nav-item.active,
            .nav-item:hover {
                border-left: none;
                border-bottom-color: #3b82f6;
            }
            
            .trading-sidebar {
                position: relative;
                width: 100%;
                height: auto;
                border-left: none;
                border-top: 1px solid #1f2937;
            }
            
            .content-area {
                max-width: 100%;
                padding: 1rem;
            }
        }

        @media (max-width: 768px) {
            .betting-interface {
                grid-template-columns: 1fr;
            }
            
            .waterfall {
                grid-template-columns: 1fr;
            }
            
            .topic-stats {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }
            
            .amount-input-group {
                flex-direction: column;
            }
            
            .profile-stats {
                grid-template-columns: 1fr;
            }
        }

        /* æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            max-width: 400px;
            width: 90%;
            text-align: center;
        }

        .modal-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1.5rem;
        }

        /* å‰µå»ºé é¢åˆ†å€æ¨£å¼ */
        .form-section {
            background: rgba(31, 41, 55, 0.5);
            border: 1px solid rgba(75, 85, 99, 0.3);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .section-header {
            margin-bottom: 1.5rem;
            border-bottom: 1px solid rgba(75, 85, 99, 0.3);
            padding-bottom: 1rem;
        }

        .section-title {
            color: #ffffff;
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .section-subtitle {
            color: #9ca3af;
            font-size: 0.9rem;
            margin: 0;
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: rgba(17, 24, 39, 0.5);
            border: 1px solid rgba(75, 85, 99, 0.5);
            border-radius: 8px;
            padding: 0.75rem 1rem;
        }

        .input-label {
            color: #9ca3af;
            font-size: 0.9rem;
            white-space: nowrap;
        }

        .input-group .form-input {
            flex: 1;
            background: transparent;
            border: none;
            margin: 0;
            padding: 0;
        }

        .input-unit {
            color: #60a5fa;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .pump-explanation {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            padding: 1.25rem;
            margin-top: 1rem;
        }

        .explanation-title {
            color: #60a5fa;
            font-weight: 600;
            margin-bottom: 0.75rem;
            font-size: 0.95rem;
        }

        .explanation-list {
            margin: 0;
            padding-left: 1.25rem;
            color: #9ca3af;
            font-size: 0.85rem;
            line-height: 1.5;
        }

        .explanation-list li {
            margin-bottom: 0.5rem;
        }

        #pumpSection.disabled {
            opacity: 0.5;
            pointer-events: none;
        }

        #pumpSection.disabled::before {
            content: "ç§å¯†è©±é¡Œä¸æ”¯æ´PumpåŠŸèƒ½";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(239, 68, 68, 0.9);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 500;
            z-index: 10;
        }

        #pumpSection {
            position: relative;
        }

        .pool-section-badge.private {
            background: rgba(239, 68, 68, 0.2);
            color: #f87171;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        /* é¸é …è¨­ç½®æ¨£å¼ */
        .option-type-selector {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1rem;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .radio-option input[type="radio"] {
            margin: 0;
        }

        .radio-label {
            color: #ffffff;
            font-size: 0.9rem;
        }

        .custom-options-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .btn-sm {
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
        }

        .option-input {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
            align-items: center;
        }

        .option-input .form-input {
            flex: 1;
        }

        .option-input .option-number {
            color: #9ca3af;
            font-size: 0.9rem;
            min-width: 60px;
        }

        /* PKå°å£˜ç•Œé¢æ¨£å¼ */
        .pk-arena {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: rgba(17, 24, 39, 0.5);
            border-radius: 12px;
            border: 1px solid rgba(75, 85, 99, 0.3);
        }

        .pk-side {
            flex: 1;
            background: rgba(31, 41, 55, 0.8);
            border-radius: 8px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .pk-side:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .pk-side.selected {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }

        .yes-side {
            border-left: 4px solid #10b981;
        }

        .yes-side:hover {
            border-left-color: #059669;
            background: rgba(16, 185, 129, 0.05);
        }

        .no-side {
            border-right: 4px solid #ef4444;
        }

        .no-side:hover {
            border-right-color: #dc2626;
            background: rgba(239, 68, 68, 0.05);
        }

        .pk-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .pk-icon {
            font-size: 1.25rem;
        }

        .pk-label {
            font-weight: 600;
            color: #ffffff;
            font-size: 1rem;
        }

        .pk-stats {
            text-align: center;
            color: #9ca3af;
            font-size: 0.85rem;
        }

        .pk-amount {
            font-size: 1.1rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 0.25rem;
        }

        .pk-percentage {
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }

        .pk-participants {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .pk-indicator {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, #3b82f6, transparent);
            transition: width 0.3s ease;
            width: 0%;
        }

        .yes-side .pk-indicator {
            background: linear-gradient(90deg, transparent, #10b981, transparent);
        }

        .no-side .pk-indicator {
            background: linear-gradient(90deg, transparent, #ef4444, transparent);
        }

        .pk-vs {
            text-align: center;
            color: #ffffff;
            font-weight: bold;
            flex-shrink: 0;
            padding: 0 0.5rem;
        }

        .vs-text {
            font-size: 1.5rem;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
        }

        .vs-subtitle {
            font-size: 0.7rem;
            color: #9ca3af;
            margin-top: 0.25rem;
        }

        /* Kç·šåœ–æ¨£å¼ */
        .kline-chart-container {
            background: rgba(17, 24, 39, 0.8);
            border-radius: 8px;
            border: 1px solid rgba(75, 85, 99, 0.3);
            overflow: hidden;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1rem;
            background: rgba(31, 41, 55, 0.5);
            border-bottom: 1px solid rgba(75, 85, 99, 0.3);
        }

        .chart-title {
            color: #ffffff;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .chart-controls {
            display: flex;
            gap: 0.5rem;
        }

        .chart-btn {
            padding: 0.25rem 0.5rem;
            background: transparent;
            border: 1px solid rgba(75, 85, 99, 0.5);
            color: #9ca3af;
            border-radius: 4px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .chart-btn:hover {
            background: rgba(75, 85, 99, 0.3);
            color: #ffffff;
        }

        .chart-btn.active {
            background: #3b82f6;
            color: #ffffff;
            border-color: #3b82f6;
        }

        .kline-chart {
            height: 280px;
            position: relative;
            padding: 1rem;
            background: rgba(17, 24, 39, 0.5);
        }

        .kline-bar {
            position: absolute;
            bottom: 1rem;
            width: 8px;
            border-radius: 1px;
            transition: all 0.3s;
        }

        .kline-bar.up {
            background: linear-gradient(180deg, #10b981, #059669);
            border: 1px solid #10b981;
        }

        .kline-bar.down {
            background: linear-gradient(180deg, #ef4444, #dc2626);
            border: 1px solid #ef4444;
        }

        .price-indicator {
            position: absolute;
            right: 0.5rem;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(59, 130, 246, 0.8);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .chart-tooltip {
            position: absolute;
            background: rgba(17, 24, 39, 0.95);
            border: 1px solid rgba(75, 85, 99, 0.5);
            border-radius: 4px;
            padding: 0.5rem;
            font-size: 0.75rem;
            color: #ffffff;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 100;
        }
    </style>
</head>
<body>
    <!-- å·¦å´å°èˆªæ¬„ -->
    <nav class="sidebar">
        <div class="sidebar-header">
            <div class="logo">BitX äº¤æ˜“åŸå‹</div>
        </div>
        <div class="sidebar-nav">
            <a href="#" class="nav-item active" onclick="showPage('home')">
                <span class="nav-icon">ğŸ </span>ç†±é–€è©±é¡Œ
            </a>
            <a href="#" class="nav-item" onclick="showPage('inner')">
                <span class="nav-icon">ğŸ“Š</span>å…§ç›¤è©±é¡Œ(æ¼”ç¤º)
            </a>
            <a href="#" class="nav-item" onclick="showPage('create')">
                <span class="nav-icon">â•</span>å‰µå»ºè©±é¡Œ
            </a>
            <a href="#" class="nav-item" onclick="showPage('profile')">
                <span class="nav-icon">ğŸ‘¤</span>å€‹äººä¸­å¿ƒ
            </a>
        </div>
    </nav>

    <!-- ä¸»å¸ƒå±€å®¹å™¨ -->
    <div class="main-layout">
        <!-- é¦–é /ç€‘å¸ƒæµ -->
        <div id="home" class="page active">
            <div class="content-area">
                <h1 style="text-align: center; margin-bottom: 2rem; color: #ffffff; font-weight: 700; font-size: 2rem;">ç†±é–€è©±é¡Œ</h1>
                <div class="waterfall" id="topicWaterfall">
                    <!-- è©±é¡Œå¡ç‰‡å°‡é€šéJavaScriptå‹•æ…‹ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <!-- å…§ç›¤è©±é¡Œé é¢ -->
        <div id="inner" class="page">
            <div class="content-area">
                <h1 style="text-align: center; margin-bottom: 2rem; color: #ffffff; font-weight: 700; font-size: 2rem;">å…§ç›¤è©±é¡Œ</h1>
                <div class="waterfall" id="innerTopicWaterfall">
                    <!-- å…§ç›¤è©±é¡Œå¡ç‰‡å°‡é€šéJavaScriptå‹•æ…‹ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <!-- å‰µå»ºè©±é¡Œé é¢ -->
        <div id="create" class="page">
            <div class="content-area">
                <div class="create-form">
                    <h2 style="text-align: center; margin-bottom: 2rem; color: #ffffff; font-weight: 700; font-size: 1.75rem;">å‰µå»ºæ–°è©±é¡Œ</h2>
                
                    <form id="createTopicForm">
                        <!-- ç¬¬ä¸€éƒ¨åˆ†ï¼šè©±é¡Œè¨­å®š -->
                        <div class="form-section">
                            <div class="section-header">
                                <h3 class="section-title">ğŸ“ è©±é¡Œè¨­å®š</h3>
                                <p class="section-subtitle">è¨­å®šè©±é¡Œçš„åŸºæœ¬è³‡è¨Š</p>
                            </div>

                            <div class="form-group">
                                <label class="form-label">è©±é¡Œå…§å®¹ *</label>
                                <textarea class="form-input form-textarea" name="content" placeholder="è«‹è¼¸å…¥æ‚¨è¦é¢„æµ‹çš„è©±é¡Œå…§å®¹..." required></textarea>
                            </div>

                            <div class="form-group">
                                <label class="form-label">è©±é¡Œé ­åƒ</label>
                                <input type="file" class="form-input" name="avatar" accept="image/*">
                                <small style="color: #6b7280; margin-top: 0.5rem; display: block;">æ”¯æ´ JPGã€PNGã€GIF æ ¼å¼ï¼Œå»ºè­°å°ºå¯¸ 200x200 åƒç´ </small>
                            </div>

                            <div class="form-group">
                                <label class="form-label">è©±é¡Œé¡åˆ¥ *</label>
                                <select class="form-input" name="category" required>
                                    <option value="">è«‹é¸æ“‡é¡åˆ¥</option>
                                    <option value="sports">é«”è‚²è³½äº‹</option>
                                    <option value="politics">æ”¿æ²»é¸èˆ‰</option>
                                    <option value="crypto">åŠ å¯†è²¨å¹£</option>
                                    <option value="economy">ç¶“æ¿Ÿé æ¸¬</option>
                                    <option value="entertainment">å¨›æ¨‚å…«å¦</option>
                                    <option value="technology">ç§‘æŠ€ç™¼å±•</option>
                                    <option value="other">å…¶ä»–</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <div class="checkbox-group">
                                    <input type="checkbox" id="isPrivate" name="isPrivate" onchange="togglePumpSettings()">
                                    <label for="isPrivate" class="form-label" style="margin-bottom: 0;">ç§å¯†è©±é¡Œ</label>
                                </div>
                                <small style="color: #6b7280; margin-top: 0.5rem; display: block;">ç§å¯†è©±é¡Œä¸æœƒå‡ºç¾åœ¨ç€‘å¸ƒæµä¸­ï¼Œä¹Ÿä¸æœƒè§¸ç™¼Pumpè½‰å¤–ç›¤</small>
                            </div>

                            <div class="form-group">
                                <label class="form-label">é¸é …è¨­ç½®</label>
                                <div class="options-container">
                                    <div class="option-type-selector">
                                        <label class="radio-option">
                                            <input type="radio" name="optionType" value="binary" checked onchange="toggleOptionType()">
                                            <span class="radio-label">YES/NO äºŒå…ƒé¸æ“‡</span>
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="optionType" value="custom" onchange="toggleOptionType()">
                                            <span class="radio-label">è‡ªå®šç¾©é¸é …ï¼ˆ2å€‹æˆ–ä»¥ä¸Šï¼‰</span>
                                        </label>
                                    </div>
                                    
                                    <div id="customOptions" style="display: none; margin-top: 1rem;">
                                        <div class="custom-options-header">
                                            <span style="color: #9ca3af; font-size: 0.9rem;">è«‹æ·»åŠ è‡³å°‘2å€‹é¸é …ï¼š</span>
                                            <button type="button" class="btn btn-outline btn-sm" onclick="addOption()">+ æ·»åŠ é¸é …</button>
                                        </div>
                                        <div id="optionsList">
                                            <!-- å‹•æ…‹ç”Ÿæˆçš„é¸é …è¼¸å…¥æ¡† -->
                                        </div>
                                        <div class="option-notice" style="color: #6b7280; font-size: 0.85rem; margin-top: 0.5rem;">
                                            æœ€å°‘éœ€è¦2å€‹é¸é …ï¼Œæœ€å¤šæ”¯æ´8å€‹é¸é …
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ç¬¬äºŒéƒ¨åˆ†ï¼šPumpè¨­å®š -->
                        <div class="form-section" id="pumpSection">
                            <div class="section-header">
                                <h3 class="section-title">ğŸš€ Pumpè¨­å®š</h3>
                                <p class="section-subtitle">è¨­å®šå…§ç›¤è½‰å¤–ç›¤çš„æ¢ä»¶</p>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Pumpè§¸ç™¼æ¢ä»¶ *</label>
                                <div class="input-group">
                                    <span class="input-label">è³‡é‡‘æ± é”åˆ°</span>
                                    <input type="number" class="form-input" name="pumpCondition" value="1000" min="1000" step="100" required>
                                    <span class="input-unit">USDT</span>
                                </div>
                                <small style="color: #6b7280; margin-top: 0.5rem; display: block;">æœ€å°å€¼ç‚º1000 USDTï¼Œå»ºè­°è¨­å®šç‚º100çš„å€æ•¸</small>
                            </div>

                            <div class="pump-explanation">
                                <div class="explanation-title">ğŸ’¡ Pumpæ©Ÿåˆ¶èªªæ˜</div>
                                <ul class="explanation-list">
                                    <li>å…§ç›¤é”åˆ°è¨­å®šé‡‘é¡æ™‚è‡ªå‹•è§¸ç™¼Pump</li>
                                    <li>ä¸‹æ³¨é‡‘é¡è¼ƒå°ä¸€æ–¹çš„50%è½‰ç‚ºå¤–ç›¤LMSRåº•æ± </li>
                                    <li>è½‰ç‚ºå¤–ç›¤å¾Œå¯åœ¨ç€‘å¸ƒæµä¸­å±•ç¤ºå’Œäº¤æ˜“</li>
                                    <li>å…§ç›¤äº¤æ˜“æ”¶å–5%æ‰‹çºŒè²»</li>
                                    <li>å¤–ç›¤äº¤æ˜“æ‰‹çºŒè²»çš„40%æŒçºŒå›æµå…§ç›¤</li>
                                </ul>
                            </div>
                        </div>

                        <!-- ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ™‚é–“è¨­å®š -->
                        <div class="form-section">
                            <div class="section-header">
                                <h3 class="section-title">â° æ™‚é–“è¨­å®š</h3>
                                <p class="section-subtitle">è¨­å®šè©±é¡Œçš„ç”Ÿå‘½é€±æœŸæ™‚é–“</p>
                            </div>

                            <div class="form-group">
                                <label class="form-label">å…§ç›¤äº¤æ˜“çµæŸæ™‚é–“ *</label>
                                <input type="datetime-local" class="form-input" name="tradingEndTime" required onchange="updateAdvancedSettings()">
                                <small style="color: #6b7280; margin-top: 0.5rem; display: block;">åœ¨æ­¤æ™‚é–“å…§å¯ä»¥é€²è¡Œå…§ç›¤äº¤æ˜“ï¼Œå¯è§¸ç™¼Pumpè½‰å¤–ç›¤</small>
                            </div>

                            <div class="form-group">
                                <label class="form-label">è©±é¡ŒçµæŸæ™‚é–“ *</label>
                                <input type="datetime-local" class="form-input" name="topicEndTime" required onchange="updateAdvancedSettings()">
                                <small style="color: #6b7280; margin-top: 0.5rem; display: block;">è©±é¡ŒçµæŸå¾Œæ‰€æœ‰äº¤æ˜“åœæ­¢ä¸¦é€²è¡Œçµç®—ï¼Œéœ€å¤§æ–¼å…§ç›¤äº¤æ˜“çµæŸæ™‚é–“</small>
                            </div>

                            <div class="form-group">
                                <div class="checkbox-group">
                                    <input type="checkbox" id="showAdvanced" onchange="toggleAdvancedSettings()">
                                    <label for="showAdvanced" class="form-label" style="margin-bottom: 0;">é¡¯ç¤ºé«˜ç´šè¨­å®š</label>
                                </div>
                            </div>

                            <div id="advancedSettings" style="display: none;">
                                <div class="form-group">
                                    <label class="form-label">å¤–ç›¤äº¤æ˜“çµæŸæ™‚é–“</label>
                                    <input type="datetime-local" class="form-input" name="outerTradingEndTime">
                                    <small style="color: #6b7280; margin-top: 0.5rem; display: block;">ç•™ç©ºå‰‡èˆ‡è©±é¡ŒçµæŸæ™‚é–“ç›¸åŒã€‚è¨­å®šå¾Œï¼Œå¤–ç›¤å°‡åœ¨æ­¤æ™‚é–“åœæ­¢äº¤æ˜“ä½†è©±é¡Œç¹¼çºŒè‡³çµæŸæ™‚é–“</small>
                                </div>
                            </div>
                        </div>

                        <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 3rem;">
                            <button type="button" class="btn btn-secondary" onclick="showPage('home')">å–æ¶ˆ</button>
                            <button type="submit" class="btn btn-primary">å‰µå»ºè©±é¡Œ</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- è©±é¡Œè©³æƒ…é¡µé¢ -->
        <div id="detail" class="page">
            <div class="content-area">
                <div class="topic-detail-container">
                    <div class="topic-header">
                        <div class="topic-avatar" id="detailAvatar">A</div>
                        <div class="topic-info">
                            <h1 class="topic-title" id="detailTitle">è¯é¢˜æ ‡é¢˜</h1>
                            <div class="topic-meta">
                                <span class="topic-category" id="detailCategory">ç±»åˆ«</span>
                                <span class="status-badge status-inner" id="detailStatus">å…§ç›¤äº¤æ˜“</span>
                                <span id="detailEndTime">çµæŸæ™‚é–“ï¼š2024-12-31 23:59</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem; color: #9ca3af; line-height: 1.6;" id="detailDescription">
                        è¿™é‡Œæ˜¾ç¤ºè¯é¢˜çš„è¯¦ç»†æè¿°å†…å®¹...
                    </div>

                    <!-- Kç·šåœ–å€åŸŸ (åƒ…å¤–ç›¤é¡¯ç¤º) -->
                    <div id="centerKlineSection" style="margin-top: 2rem; display: none;">
                        <div class="kline-chart-container">
                            <div class="chart-header">
                                <span class="chart-title">ğŸ’¹ åƒ¹æ ¼èµ°å‹¢åœ–</span>
                                <div class="chart-controls">
                                    <button class="chart-btn active" onclick="switchTimeframe('1m')">1åˆ†</button>
                                    <button class="chart-btn" onclick="switchTimeframe('5m')">5åˆ†</button>
                                    <button class="chart-btn" onclick="switchTimeframe('1h')">1å°æ™‚</button>
                                </div>
                            </div>
                            <div id="centerKlineChart" class="kline-chart"></div>
                        </div>
                    </div>

                    <!-- èµ„é‡‘æ± çŠ¶æ€è¯¦æƒ… -->
                    <div style="margin-top: 2rem;" id="poolDetailsSection">
                        <!-- èµ„é‡‘æ± ä¿¡æ¯å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>
        </div>

        <!-- å€‹äººä¸­å¿ƒé¡µé¢ -->
        <div id="profile" class="page">
            <div class="content-area">
                <h1 style="text-align: center; margin-bottom: 2rem; color: #ffffff; font-weight: 700; font-size: 1.75rem;">å€‹äººä¸­å¿ƒ</h1>
                
                <div class="profile-stats">
                    <div class="stat-card primary">
                        <h3>æŒå€‰åƒ¹å€¼</h3>
                        <div class="value" id="totalAssets">1,234.56 U</div>
                    </div>
                    <div class="stat-card positive">
                        <h3>ç¸½ç›ˆè™§</h3>
                        <div class="value" id="totalProfit">+234.56 U</div>
                    </div>
                    <div class="stat-card">
                        <h3>åƒèˆ‡è©±é¡Œ</h3>
                        <div class="value" style="color: #60a5fa;" id="totalTopics">8</div>
                    </div>
                    <div class="stat-card">
                        <h3>ç¸½äº¤æ˜“é‡</h3>
                        <div class="value" style="color: #34d399;" id="totalTrades">30M U</div>
                    </div>
                </div>

                <!-- æŒä»“è®°å½• -->
                <div class="topic-detail-container" style="margin-bottom: 2rem;">
                    <h3 style="margin-bottom: 1.5rem; color: #ffffff; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="color: #3b82f6;">ğŸ“Š</span> ç•¶å‰æŒå€‰
                    </h3>
                    <div id="currentPositions">
                        <!-- æŒä»“æ•°æ®å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                    </div>
                </div>

                <!-- äº¤æ˜“æ­·å² -->
                <div class="topic-detail-container">
                    <h3 style="margin-bottom: 1.5rem; color: #ffffff; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="color: #10b981;">ğŸ“ˆ</span> äº¤æ˜“æ­·å²
                    </h3>
                    <div id="tradingHistory">
                        <!-- äº¤æ˜“æ­·å²å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å³ä¾§äº¤æ˜“æ  -->
    <div class="trading-sidebar hidden" id="tradingSidebar">
        <div class="trading-header">
            <div class="trading-title" id="tradingTitle">äº¤æ˜“é¢æ¿</div>
            <div class="trading-subtitle" id="tradingSubtitle">é¸æ“‡æ‚¨çš„é¢„æµ‹å¹¶ä¸‹æ³¨</div>
        </div>

        <!-- å…§ç›¤äº¤æ˜“ç•Œé¢ -->
        <div id="innerTrading" class="trading-section">
            <div class="section-title">PKå°å£˜ - é¸æ“‡é™£ç‡Ÿ</div>
            
            <!-- PKå°æˆ°ç•Œé¢ -->
            <div class="pk-arena">
                <div class="pk-side yes-side" onclick="selectOption('yes')">
                    <div class="pk-header">
                        <div class="pk-icon">ğŸ‘</div>
                        <div class="pk-label">YESé™£ç‡Ÿ</div>
                    </div>
                    <div class="pk-stats">
                        <div class="pk-amount" id="yesAmount">0 USDT</div>
                        <div class="pk-percentage" id="yesPercentage">0%</div>
                        <div class="pk-participants" id="yesParticipants">0äºº</div>
                    </div>
                    <div class="pk-indicator" id="yesIndicator"></div>
                </div>
                
                <div class="pk-vs">
                    <div class="vs-text">VS</div>
                    <div class="vs-subtitle">é æ¸¬å°æ±º</div>
                </div>
                
                <div class="pk-side no-side" onclick="selectOption('no')">
                    <div class="pk-header">
                        <div class="pk-icon">ğŸ‘</div>
                        <div class="pk-label">NOé™£ç‡Ÿ</div>
                    </div>
                    <div class="pk-stats">
                        <div class="pk-amount" id="noAmount">0 USDT</div>
                        <div class="pk-percentage" id="noPercentage">0%</div>
                        <div class="pk-participants" id="noParticipants">0äºº</div>
                    </div>
                    <div class="pk-indicator" id="noIndicator"></div>
                </div>
            </div>

            <div class="amount-input-group">
                <input type="number" class="amount-input" id="betAmount" placeholder="è¼¸å…¥ä¸‹æ³¨é‡‘é¡" min="1" step="1">
                <button class="btn btn-success" onclick="placeBet()" style="width: 100%;">åŠ å…¥é™£ç‡Ÿ</button>
            </div>
        </div>

        <!-- å¤–ç›¤äº¤æ˜“ç•Œé¢ -->
        <div id="outerTrading" class="trading-section" style="display: none;">
            <div class="section-title">LMSRäº¤æ˜“</div>
            
            <!-- åƒ¹æ ¼æ˜¾ç¤ºåŒºåŸŸ -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1.5rem;">
                <div class="price-card yes-price">
                    <div class="price-label">YES</div>
                    <div class="price-value" id="yesPriceDisplay">0.500</div>
                    <div class="price-unit">USDT</div>
                </div>
                <div class="price-card no-price">
                    <div class="price-label">NO</div>
                    <div class="price-value" id="noPriceDisplay">0.500</div>
                    <div class="price-unit">USDT</div>
                </div>
            </div>

            <!-- äº¤æ˜“è¡¨å• -->
            <div class="trading-form">
                <div class="form-group" style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; color: #9ca3af; font-size: 0.85rem;">äº¤æ˜“æ•¸é‡</label>
                    <input type="number" class="amount-input" id="lmsrAmount" placeholder="è¼¸å…¥äº¤æ˜“æ•¸é‡" min="0.1" step="0.1">
                </div>
                
                <div class="trading-buttons">
                    <div style="margin-bottom: 1rem;">
                        <div style="text-align: center; margin-bottom: 0.5rem; color: #9ca3af; font-size: 0.85rem;">è²·å…¥</div>
                        <button class="btn btn-success lmsr-buy-btn" onclick="buyLMSR('yes')" style="width: 100%; margin-bottom: 0.5rem;">
                            <span>è²·å…¥ YES</span>
                            <small id="yesBuyInfo" style="display: block; font-size: 0.75rem; opacity: 0.8;">é è¨ˆèŠ±è²»: 0 USDT</small>
                        </button>
                        <button class="btn btn-danger lmsr-buy-btn" onclick="buyLMSR('no')" style="width: 100%;">
                            <span>è²·å…¥ NO</span>
                            <small id="noBuyInfo" style="display: block; font-size: 0.75rem; opacity: 0.8;">é è¨ˆèŠ±è²»: 0 USDT</small>
                        </button>
                    </div>
                    
                    <div>
                        <div style="text-align: center; margin-bottom: 0.5rem; color: #9ca3af; font-size: 0.85rem;">è³£å‡º</div>
                        <button class="btn btn-outline btn-success" onclick="sellLMSR('yes')" style="width: 100%; margin-bottom: 0.5rem;">
                            <span>è³£å‡º YES</span>
                            <small id="yesSellInfo" style="display: block; font-size: 0.75rem; opacity: 0.8;">é è¨ˆæ”¶å…¥: 0 USDT</small>
                        </button>
                        <button class="btn btn-outline btn-danger" onclick="sellLMSR('no')" style="width: 100%;">
                            <span>è³£å‡º NO</span>
                            <small id="noSellInfo" style="display: block; font-size: 0.75rem; opacity: 0.8;">é è¨ˆæ”¶å…¥: 0 USDT</small>
                        </button>
                    </div>
                </div>
            </div>
        </div>



        <!-- æˆ‘çš„æŒä»“ -->
        <div class="trading-section">
            <div class="section-title">æˆ‘çš„æŒä»“</div>
            
            <!-- å¤–ç›¤æŒå€‰ -->
            <div class="pool-section" id="myOuterPositions" style="display: none;">
                <div class="pool-section-header">
                    <span class="pool-section-title">å¤–ç›¤æŒå€‰</span>
                    <span class="pool-section-badge outer">LMSRä»£å¹£</span>
                </div>
                <div class="pool-info">
                    <div class="pool-row">
                        <span class="pool-label">YESä»£å¹£ï¼š</span>
                        <span class="pool-value" id="myOuterYes">0 ä¸ª</span>
                    </div>
                    <div class="pool-row">
                        <span class="pool-label">NOä»£å¹£ï¼š</span>
                        <span class="pool-value" id="myOuterNo">0 ä¸ª</span>
                    </div>
                    <div class="pool-row">
                        <span class="pool-label">ä¼°å€¼ï¼š</span>
                        <span class="pool-value" id="myOuterValue">0 USDT</span>
                    </div>
                </div>
            </div>

            <!-- å…§ç›¤æŒå€‰ -->
            <div class="pool-section" id="myInnerPositions">
                <div class="pool-section-header">
                    <span class="pool-section-title">å…§ç›¤æŒå€‰</span>
                    <span class="pool-section-badge">åŸå§‹ä¸‹æ³¨</span>
                </div>
                <div class="pool-info">
                    <div class="pool-row">
                        <span class="pool-label">YESæŒä»“ï¼š</span>
                        <span class="pool-value" id="myInnerYes">0 USDT</span>
                    </div>
                    <div class="pool-row">
                        <span class="pool-label">NOæŒä»“ï¼š</span>
                        <span class="pool-value" id="myInnerNo">0 USDT</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- åˆ†äº«æŒ‰é’® -->
        <div class="trading-section">
            <button class="btn btn-secondary" style="width: 100%;" onclick="shareLink()">
                ğŸ“¤ åˆ†äº«é€£çµ
            </button>
        </div>
    </div>



    <!-- ç¢ºèªæ¨¡æ€æ¡† -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-title">ç¢ºèªä¸‹æ³¨</div>
            <div id="confirmText">æ‚¨ç¡®å®šè¦ä¸‹æ³¨ 100 USDT åˆ° YES å—ï¼Ÿ</div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="confirmBet()">ç¢ºèª</button>
            </div>
        </div>
    </div>

    <!-- Pumpé€šçŸ¥æ¨¡æ€æ¡† -->
    <div id="pumpModal" class="modal">
        <div class="modal-content">
            <div class="modal-title">ğŸ‰ PumpæˆåŠŸï¼</div>
            <div>æ­å–œï¼è¯é¢˜å·²æˆåŠŸä»å†…ç›˜è½¬æ¢ä¸ºå¤–ç›˜ï¼Œç°åœ¨å¯ä»¥è¿›è¡ŒLMSRäº¤æ˜“äº†ï¼</div>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="closePumpModal()">æŸ¥çœ‹å¤–ç›˜</button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€çŠ¶æ€ç®¡ç†
        let currentPage = 'home';
        let selectedOption = null;
        let topics = [];
        let currentTopic = null;

        // æ¨¡æ‹Ÿæ•°æ®
        const sampleTopics = [
            {
                id: 1,
                title: "æ¯”ç‰¹å¹£åƒ¹æ ¼åœ¨2025å¹´åº•èƒ½å¦çªç ´15è¬ç¾å…ƒï¼Ÿ",
                category: "crypto",
                categoryName: "åŠ å¯†è²¨å¹£",
                avatar: "â‚¿",
                // å†…ç›˜æ•°æ®ï¼ˆPumpå‰çš„åŸå§‹ä¸‹æ³¨ï¼‰
                innerPool: {
                    yesAmount: 600,
                    noAmount: 400,
                    totalAmount: 1000
                },
                // å¤–ç›˜æ•°æ®ï¼ˆLMSRåº•æ±  + äº¤æ˜“ï¼‰
                outerPool: {
                    basePool: 200, // ä»å†…ç›˜å°æ–¹50%è½¬å…¥çš„åº•æ± 
                    yesAmount: 320, // å¤–ç›˜YESäº¤æ˜“é‡
                    noAmount: 280,  // å¤–ç›˜NOäº¤æ˜“é‡
                    totalAmount: 600,
                    tradingFeeToInner: 12 // å¤–ç›¤äº¤æ˜“æ‰‹çºŒè²»è½¬å…¥å†…ç›˜çš„é‡‘é¢
                },
                isOuter: true,
                endTime: "2025-12-31",
                status: "outer",
                description: "éš¨è‘—æ¯”ç‰¹å¹£ETFç²æ‰¹å’Œæ©Ÿæ§‹æ¡ç”¨å¢åŠ ï¼Œæ¯”ç‰¹å¹£åƒ¹æ ¼æ˜¯å¦èƒ½åœ¨2025å¹´åº•çªç ´æ­·å²æ–°é«˜15è¬ç¾å…ƒï¼Ÿ",
                isPrivate: false,
                pumpCondition: 1000, // è‡ªå®šç¾©Pumpæ¢ä»¶
                outerTradingEndTime: "2025-12-31", // å¤–ç›¤äº¤æ˜“çµæŸæ™‚é–“
                // å…§ç›¤æŒå€‰ï¼ˆåŸå§‹ä¸‹æ³¨ï¼‰
                myInnerYes: 100,
                myInnerNo: 0,
                // å¤–ç›¤æŒå€‰ï¼ˆLMSRä»£å¹£ï¼‰
                myOuterYes: 15,
                myOuterNo: 0
            },
            {
                id: 2,
                title: "2024å¹´ç¾åœ‹ç¸½çµ±å¤§é¸çµæœé æ¸¬",
                category: "politics", 
                categoryName: "æ”¿æ²»é€‰ä¸¾",
                avatar: "ğŸ—³",
                innerPool: {
                    yesAmount: 800,
                    noAmount: 1200,
                    totalAmount: 2000
                },
                outerPool: {
                    basePool: 400, // ä»å†…ç›˜å°æ–¹(YES)50%è½¬å…¥
                    yesAmount: 600,
                    noAmount: 800,
                    totalAmount: 1400,
                    tradingFeeToInner: 28
                },
                isOuter: true,
                endTime: "2024-11-05",
                status: "outer",
                description: "é æ¸¬2024å¹´ç¾åœ‹ç¸½çµ±å¤§é¸çš„çµæœï¼ŒYESä»£è¡¨å…±å’Œé»¨ç²å‹ï¼ŒNOä»£è¡¨æ°‘ä¸»é»¨ç²å‹ã€‚",
                myInnerYes: 50,
                myInnerNo: 200,
                myOuterYes: 0,
                myOuterNo: 25
            },
            {
                id: 3,
                title: "OpenAI GPT-5æ˜¯å¦æœƒåœ¨2024å¹´ç™¼å¸ƒï¼Ÿ",
                category: "technology",
                categoryName: "ç§‘æŠ€å‘å±•", 
                avatar: "ğŸ¤–",
                innerPool: {
                    yesAmount: 200,
                    noAmount: 150,
                    totalAmount: 350
                },
                outerPool: null, // è¿˜æœªPump
                isOuter: false,
                endTime: "2024-12-31",
                status: "inner",
                description: "OpenAIæ˜¯å¦æœƒåœ¨2024å¹´å†…ç™¼å¸ƒGPT-5æ¨¡å‹ï¼ŸåŸºäºå½“å‰çš„æŠ€è¡“å‘å±•è¿›åº¦å’Œå…¬å¸å…¬å‘Šè¿›è¡Œé¢„æµ‹ã€‚",
                myInnerYes: 0,
                myInnerNo: 0,
                myOuterYes: 0,
                myOuterNo: 0
            },
            {
                id: 4,
                title: "ç‰¹æ–¯æ‹‰è‚¡åƒ¹èƒ½å¦åœ¨2024å¹´è¶…é300ç¾å…ƒï¼Ÿ",
                category: "economy",
                categoryName: "ç¶“æ¿Ÿé¢„æµ‹",
                avatar: "ğŸš—",
                innerPool: {
                    yesAmount: 80,
                    noAmount: 120,
                    totalAmount: 200
                },
                outerPool: null,
                isOuter: false,
                endTime: "2024-12-31",
                status: "inner",
                description: "è€ƒæ…®åˆ°é›»å‹•è»Šå¸‚å ´ç«¶çˆ­å’Œç‰¹æ–¯æ‹‰çš„æ¥­å‹™ç™¼å±•ï¼Œå…¶è‚¡åƒ¹æ˜¯å¦èƒ½åœ¨2024å¹´çªç ´300ç¾å…ƒï¼Ÿ",
                myInnerYes: 50,
                myInnerNo: 0,
                myOuterYes: 0,
                myOuterNo: 0
            }
        ];

        // é¡µé¢åˆ‡æ¢
        function showPage(pageId) {
            // æ›´æ–°é¡µé¢æ˜¾ç¤º
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // æ›´æ–°å¯¼èˆªçŠ¶æ€
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // æ ¹æ®é¡µé¢è®¾ç½®å¯¹åº”çš„å¯¼èˆªé¡¹ä¸ºæ´»è·ƒçŠ¶æ€
            const navMap = {
                'home': 0,
                'inner': 1,
                'create': 2,
                'profile': 3
            };
            if (navMap[pageId] !== undefined) {
                document.querySelectorAll('.nav-item')[navMap[pageId]].classList.add('active');
            }
            
            currentPage = pageId;

            // æ§åˆ¶äº¤æ˜“æ æ˜¾ç¤º
            const tradingSidebar = document.getElementById('tradingSidebar');
            if (pageId === 'detail') {
                tradingSidebar.classList.remove('hidden');
            } else {
                tradingSidebar.classList.add('hidden');
            }

            if (pageId === 'home') {
                renderTopics();
            } else if (pageId === 'inner') {
                renderInnerTopics();
            } else if (pageId === 'profile') {
                renderProfileData();
            }
        }

        // æ¸²æŸ“è¯é¢˜ç€‘å¸ƒæµ
        function renderTopics() {
            const waterfall = document.getElementById('topicWaterfall');
            waterfall.innerHTML = '';

            sampleTopics.filter(topic => topic.isOuter).forEach(topic => {
                const card = document.createElement('div');
                card.className = 'topic-card';
                card.onclick = () => showTopicDetail(topic.id);
                
                // è®¡ç®—å¤–ç›˜æ€»èµ„é‡‘æ± 
                const outerTotalPool = topic.outerPool.basePool + topic.outerPool.totalAmount;
                const yesPercentage = ((topic.outerPool.yesAmount / topic.outerPool.totalAmount) * 100).toFixed(1);
                
                card.innerHTML = `
                    <div class="topic-header">
                        <div class="topic-avatar">${topic.avatar}</div>
                        <div class="topic-info">
                            <h3>${topic.title}</h3>
                            <div class="topic-category">${topic.categoryName}</div>
                        </div>
                    </div>
                    <div class="topic-stats">
                        <div class="stat">
                            <div class="stat-value">${outerTotalPool}</div>
                            <div class="stat-label">å¤–ç›˜æ€»æ± (USDT)</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">${yesPercentage}%</div>
                            <div class="stat-label">Chance</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">${topic.endTime}</div>
                            <div class="stat-label">çµæŸæ™‚é–“</div>
                        </div>
                    </div>
                `;
                
                waterfall.appendChild(card);
            });
        }

        // æ¸²æŸ“å…§ç›¤è©±é¡Œç€‘å¸ƒæµ
        function renderInnerTopics() {
            const waterfall = document.getElementById('innerTopicWaterfall');
            waterfall.innerHTML = '';

            sampleTopics.filter(topic => !topic.isOuter).forEach(topic => {
                const card = document.createElement('div');
                card.className = 'topic-card';
                card.onclick = () => showTopicDetail(topic.id);
                
                // è¨ˆç®—å…§ç›¤è³‡é‡‘æ± ä¿¡æ¯
                const innerTotalPool = topic.innerPool.totalAmount;
                const yesPercentage = innerTotalPool > 0 ? ((topic.innerPool.yesAmount / innerTotalPool) * 100).toFixed(1) : '50.0';
                const pumpProgress = Math.min((innerTotalPool / 1000) * 100, 100).toFixed(1);
                
                // è¨ˆç®—åˆ°Pumpé‚„éœ€å¤šå°‘
                const pumpRemaining = Math.max(1000 - innerTotalPool, 0);
                
                card.innerHTML = `
                    <div class="topic-header">
                        <div class="topic-avatar">${topic.avatar}</div>
                        <div class="topic-info">
                            <h3>${topic.title}</h3>
                            <div class="topic-category">${topic.categoryName}</div>
                        </div>
                    </div>
                    <div class="topic-stats">
                        <div class="stat">
                            <div class="stat-value">${innerTotalPool}</div>
                            <div class="stat-label">å…§ç›¤ç¸½æ± (USDT)</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">${yesPercentage}%</div>
                            <div class="stat-label">Chance</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">${pumpProgress}%</div>
                            <div class="stat-label">Pumpé€²åº¦</div>
                        </div>
                    </div>
                    <div class="topic-progress">
                        <div style="font-size: 0.8rem; color: #9ca3af; margin-bottom: 0.5rem;">
                            è·é›¢Pumpé‚„éœ€: <strong style="color: #f59e0b;">${pumpRemaining} USDT</strong>
                        </div>
                        <div style="background: #374151; border-radius: 4px; height: 6px; overflow: hidden;">
                            <div style="background: linear-gradient(90deg, #10b981, #059669); height: 100%; width: ${pumpProgress}%; transition: width 0.3s ease;"></div>
                        </div>
                    </div>
                `;
                
                waterfall.appendChild(card);
            });

            // å¦‚æœæ²’æœ‰å…§ç›¤è©±é¡Œï¼Œé¡¯ç¤ºç©ºç‹€æ…‹
            if (waterfall.children.length === 0) {
                waterfall.innerHTML = `
                    <div style="text-align: center; padding: 3rem; color: #6b7280;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ“Š</div>
                        <h3 style="margin-bottom: 0.5rem;">æš«ç„¡å…§ç›¤è©±é¡Œ</h3>
                        <p>æ‰€æœ‰è©±é¡Œéƒ½å·²é€²å…¥å¤–ç›¤éšæ®µï¼Œæˆ–å‰µå»ºæ–°è©±é¡Œé–‹å§‹äº¤æ˜“</p>
                    </div>
                `;
            }
        }

        // æ˜¾ç¤ºè©±é¡Œè©³æƒ…
        function showTopicDetail(topicId) {
            currentTopic = sampleTopics.find(t => t.id === topicId) || {
                id: topicId,
                title: "æ–°è¯é¢˜",
                category: "other",
                categoryName: "å…¶ä»–",
                avatar: "ğŸ’¡",
                innerPool: {
                    yesAmount: 0,
                    noAmount: 0,
                    totalAmount: 0
                },
                outerPool: null,
                isOuter: false,
                endTime: "2024-12-31",
                status: "inner",
                description: "è¿™æ˜¯ä¸€ä¸ªæ–°åˆ›å»ºçš„è¯é¢˜",
                myInnerYes: 0,
                myInnerNo: 0,
                myOuterYes: 0,
                myOuterNo: 0
            };

            // æ›´æ–°é¡µé¢å†…å®¹
            document.getElementById('detailTitle').textContent = currentTopic.title;
            document.getElementById('detailCategory').textContent = currentTopic.categoryName;
            document.getElementById('detailAvatar').textContent = currentTopic.avatar;
            document.getElementById('detailEndTime').textContent = `çµæŸæ™‚é–“ï¼š${currentTopic.endTime}`;
            document.getElementById('detailDescription').textContent = currentTopic.description || currentTopic.title;
            
            // æ ¹æ®è¯é¢˜çŠ¶æ€æ›´æ–°äº¤æ˜“æ 
            updateTradingInterface();
            updatePoolDisplay();
            showPage('detail');
        }

        // æ›´æ–°äº¤æ˜“ç•Œé¢
        function updateTradingInterface() {
            if (!currentTopic) return;
            
            const isOuter = currentTopic.status === 'outer';
            const tradingTitle = document.getElementById('tradingTitle');
            const tradingSubtitle = document.getElementById('tradingSubtitle');
            const statusBadge = document.getElementById('detailStatus');
            const innerTrading = document.getElementById('innerTrading');
            const outerTrading = document.getElementById('outerTrading');
            const centerKlineSection = document.getElementById('centerKlineSection');

            if (isOuter) {
                // å¤–ç›˜çŠ¶æ€
                tradingTitle.textContent = 'LMSRäº¤æ˜“';
                tradingSubtitle.textContent = 'åŸºäºå¸‚åœºåƒ¹æ ¼çš„é¢„æµ‹å¸‚åœºäº¤æ˜“';
                statusBadge.textContent = 'å¤–ç›¤äº¤æ˜“';
                statusBadge.className = 'status-badge status-outer';
                innerTrading.style.display = 'none';
                outerTrading.style.display = 'block';
                
                // é¡¯ç¤ºä¸­é–“å€åŸŸçš„Kç·šåœ–
                if (centerKlineSection) {
                    centerKlineSection.style.display = 'block';
                }
                
                // æ›´æ–°LMSRåƒ¹æ ¼æ˜¾ç¤º
                updateLMSRPrices();
                
                // åˆå§‹åŒ–Kç·šåœ–
                setTimeout(() => {
                    initKlineChart();
                }, 100);
            } else {
                // å†…ç›˜çŠ¶æ€
                tradingTitle.textContent = 'PKå°å£˜';
                tradingSubtitle.textContent = 'é¸æ“‡é™£ç‡Ÿï¼Œé æ¸¬æœªä¾†';
                statusBadge.textContent = 'å…§ç›¤äº¤æ˜“';
                statusBadge.className = 'status-badge status-inner';
                innerTrading.style.display = 'block';
                outerTrading.style.display = 'none';
                
                // éš±è—ä¸­é–“å€åŸŸçš„Kç·šåœ–
                if (centerKlineSection) {
                    centerKlineSection.style.display = 'none';
                }
                
                // æ›´æ–°PKç•Œé¢æ•¸æ“š
                updatePKInterface();
                
                // æ£€æŸ¥æ˜¯å¦æ¥è¿‘Pumpæ¡ä»¶
                if (currentTopic.totalPool >= 800) {
                    tradingSubtitle.textContent = 'å³å°†è¾¾åˆ°Pumpæ¡ä»¶ï¼';
                    tradingSubtitle.style.color = '#f59e0b';
                } else {
                    tradingSubtitle.style.color = '#6b7280';
                }
            }
        }

        // æ›´æ–°LMSRåƒ¹æ ¼æ˜¾ç¤º
        function updateLMSRPrices() {
            if (!currentTopic || currentTopic.status !== 'outer' || !currentTopic.outerPool) return;

            // ä½¿ç”¨å¤–ç›˜æ•°æ®è®¡ç®—LMSRåƒ¹æ ¼
            const outerPool = currentTopic.outerPool;
            const totalAmount = outerPool.totalAmount;
            const yesAmount = outerPool.yesAmount;
            const noAmount = outerPool.noAmount;
            
            // åŸºæœ¬åƒ¹æ ¼è®¡ç®—ï¼ˆåŸºäºå¤–ç›˜èµ„é‡‘æ± æ¯”ä¾‹ï¼‰
            const yesPrice = (yesAmount / totalAmount).toFixed(3);
            const noPrice = (noAmount / totalAmount).toFixed(3);

            // æ›´æ–°åƒ¹æ ¼æ˜¾ç¤º
            document.getElementById('yesPriceDisplay').textContent = yesPrice;
            document.getElementById('noPriceDisplay').textContent = noPrice;

            // ç›‘å¬æ•°é‡è¼¸å…¥å˜åŒ–ï¼Œæ›´æ–°é è¨ˆèŠ±è²»å’Œæ”¶å…¥
            const amountInput = document.getElementById('lmsrAmount');
            const updateCostInfo = () => {
                const amount = parseFloat(amountInput.value) || 0;
                const yesCostBase = amount * parseFloat(yesPrice);
                const noCostBase = amount * parseFloat(noPrice);
                
                // åŒ…å«5%æ‰‹çºŒè²»çš„æ€»æˆæœ¬ï¼ˆè²·å…¥ï¼‰
                const yesCostTotal = (yesCostBase * 1.05).toFixed(2);
                const noCostTotal = (noCostBase * 1.05).toFixed(2);
                
                // æ‰£é™¤5%æ‰‹çºŒè²»çš„å‡€æ”¶å…¥ï¼ˆè³£å‡ºï¼‰
                const yesRevenueTotal = (yesCostBase * 0.95).toFixed(2);
                const noRevenueTotal = (noCostBase * 0.95).toFixed(2);
                
                // æ›´æ–°è²·å…¥ä¿¡æ¯
                document.getElementById('yesBuyInfo').textContent = `é è¨ˆèŠ±è²»: ${yesCostTotal} USDT `;
                document.getElementById('noBuyInfo').textContent = `é è¨ˆèŠ±è²»: ${noCostTotal} USDT `;
                
                // æ›´æ–°è³£å‡ºä¿¡æ¯
                document.getElementById('yesSellInfo').textContent = `é è¨ˆæ”¶å…¥: ${yesRevenueTotal} USDT`;
                document.getElementById('noSellInfo').textContent = `é è¨ˆæ”¶å…¥: ${noRevenueTotal} USDT`;
            };

            // ç»‘å®šè¼¸å…¥äº‹ä»¶
            amountInput.removeEventListener('input', updateCostInfo);
            amountInput.addEventListener('input', updateCostInfo);
            
            // åˆå§‹æ›´æ–°
            updateCostInfo();
        }

        // LMSRè²·å…¥åŠŸèƒ½
        function buyLMSR(option) {
            if (!currentTopic || currentTopic.status !== 'outer' || !currentTopic.outerPool) {
                alert('åªèƒ½åœ¨å¤–ç›˜çŠ¶æ€ä¸‹è¿›è¡ŒLMSRäº¤æ˜“');
                return;
            }

            const amount = parseFloat(document.getElementById('lmsrAmount').value);
            if (!amount || amount <= 0) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„äº¤æ˜“æ•¸é‡');
                return;
            }

            // è®¡ç®—äº¤æ˜“æˆæœ¬
            const yesPrice = parseFloat(document.getElementById('yesPriceDisplay').textContent);
            const noPrice = parseFloat(document.getElementById('noPriceDisplay').textContent);
            const cost = option === 'yes' ? amount * yesPrice : amount * noPrice;

            // è®¡ç®—2%æ‰‹çºŒè²»
            const tradingFee = cost * 0.05;
            const netCost = cost - tradingFee;

            // ç¢ºèªäº¤æ˜“
            if (confirm(`ç¢ºèªè²·å…¥ ${amount} ä¸ª ${option.toUpperCase()} ä»£å¹£ï¼Ÿ\näº¤æ˜“æˆæœ¬: ${cost.toFixed(2)} USDT\næ‰‹çºŒè²»: ${tradingFee.toFixed(2)} USDT \nå‡€æˆæœ¬: ${netCost.toFixed(2)} USDT`)) {
                // æ›´æ–°å¤–ç›¤æŒå€‰
                if (option === 'yes') {
                    currentTopic.myOuterYes = (currentTopic.myOuterYes || 0) + amount;
                } else {
                    currentTopic.myOuterNo = (currentTopic.myOuterNo || 0) + amount;
                }

                // æ›´æ–°å¤–ç›˜èµ„é‡‘æ± 
                currentTopic.outerPool.totalAmount += netCost;
                if (option === 'yes') {
                    currentTopic.outerPool.yesAmount += netCost;
                } else {
                    currentTopic.outerPool.noAmount += netCost;
                }

                // æ‰‹çºŒè²»çš„40%å›æµåˆ°å†…ç›˜
                const feeToInner = tradingFee * 0.4;
                currentTopic.outerPool.tradingFeeToInner += feeToInner;

                // æ›´æ–°sampleTopicsä¸­çš„æ•°æ®
                const topicIndex = sampleTopics.findIndex(t => t.id === currentTopic.id);
                if (topicIndex !== -1) {
                    sampleTopics[topicIndex] = {...currentTopic};
                }

                // æ›´æ–°æ˜¾ç¤º
                updateLMSRPrices();
                updatePoolDisplay();

                // æ¸…ç©ºè¼¸å…¥
                document.getElementById('lmsrAmount').value = '';

                alert(`äº¤æ˜“æˆåŠŸï¼\nè²·å…¥: ${amount} ä¸ª ${option.toUpperCase()}\næ€»èŠ±è´¹: ${cost.toFixed(2)} USDT\næ‰‹çºŒè²»: ${tradingFee.toFixed(2)} USDT (40%å·²å›æµå†…ç›˜)`);
            }
        }

        // LMSRè³£å‡ºå‡½æ•¸
        function sellLMSR(option) {
            if (!currentTopic || currentTopic.status !== 'outer' || !currentTopic.outerPool) {
                alert('åªèƒ½åœ¨å¤–ç›¤ç‹€æ…‹ä¸‹é€²è¡ŒLMSRäº¤æ˜“');
                return;
            }

            const amount = parseFloat(document.getElementById('lmsrAmount').value);
            if (!amount || amount <= 0) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„äº¤æ˜“æ•¸é‡');
                return;
            }

            // æª¢æŸ¥æŒå€‰æ˜¯å¦è¶³å¤ 
            const currentHolding = option === 'yes' ? (currentTopic.myOuterYes || 0) : (currentTopic.myOuterNo || 0);
            if (amount > currentHolding) {
                alert(`æŒå€‰ä¸è¶³ï¼æ‚¨ç›®å‰æŒæœ‰ ${currentHolding} å€‹ ${option.toUpperCase()} ä»£å¹£`);
                return;
            }

            // è¨ˆç®—è³£å‡ºæ”¶å…¥
            const yesPrice = parseFloat(document.getElementById('yesPriceDisplay').textContent);
            const noPrice = parseFloat(document.getElementById('noPriceDisplay').textContent);
            const revenue = option === 'yes' ? amount * yesPrice : amount * noPrice;

            // è¨ˆç®—2%æ‰‹çºŒè²»
            const tradingFee = revenue * 0.05;
            const netRevenue = revenue - tradingFee;

            // ç¢ºèªäº¤æ˜“
            if (confirm(`ç¢ºèªè³£å‡º ${amount} å€‹ ${option.toUpperCase()} ä»£å¹£ï¼Ÿ\nè³£å‡ºæ”¶å…¥: ${revenue.toFixed(2)} USDT\næ‰‹çºŒè²»: ${tradingFee.toFixed(2)} USDT \næ·¨æ”¶å…¥: ${netRevenue.toFixed(2)} USDT`)) {
                // æ›´æ–°å¤–ç›¤æŒå€‰
                if (option === 'yes') {
                    currentTopic.myOuterYes = (currentTopic.myOuterYes || 0) - amount;
                } else {
                    currentTopic.myOuterNo = (currentTopic.myOuterNo || 0) - amount;
                }

                // æ›´æ–°å¤–ç›¤è³‡é‡‘æ± ï¼ˆå¾æ± ä¸­å–å‡ºè³‡é‡‘ï¼‰
                currentTopic.outerPool.totalAmount -= netRevenue;
                if (option === 'yes') {
                    currentTopic.outerPool.yesAmount -= netRevenue;
                } else {
                    currentTopic.outerPool.noAmount -= netRevenue;
                }

                // æ‰‹çºŒè²»çš„40%å›æµåˆ°å…§ç›¤
                const feeToInner = tradingFee * 0.4;
                currentTopic.outerPool.tradingFeeToInner += feeToInner;

                // æ›´æ–°sampleTopicsä¸­çš„æ•¸æ“š
                const topicIndex = sampleTopics.findIndex(t => t.id === currentTopic.id);
                if (topicIndex !== -1) {
                    sampleTopics[topicIndex] = {...currentTopic};
                }

                // æ›´æ–°é¡¯ç¤º
                updateLMSRPrices();
                updatePoolDisplay();

                // æ¸…ç©ºè¼¸å…¥
                document.getElementById('lmsrAmount').value = '';

                alert(`äº¤æ˜“æˆåŠŸï¼\nè³£å‡º: ${amount} å€‹ ${option.toUpperCase()}\nç¸½æ”¶å…¥: ${revenue.toFixed(2)} USDT\næ‰‹çºŒè²»: ${tradingFee.toFixed(2)} USDT (40%å·²å›æµå…§ç›¤)`);
            }
        }

        // æ›´æ–°èµ„é‡‘æ± æ˜¾ç¤º
        function updatePoolDisplay() {
            if (!currentTopic) return;

            const isOuter = currentTopic.status === 'outer';
            
            // æ›´æ–°å…§ç›¤äº¤æ˜“ç•Œé¢çš„æ˜¾ç¤ºï¼ˆå¦‚æœå­˜åœ¨è¿™äº›å…ƒç´ ï¼‰
            if (currentTopic.innerPool) {
                const yesAmountEl = document.getElementById('yesAmount');
                const noAmountEl = document.getElementById('noAmount');
                if (yesAmountEl) yesAmountEl.textContent = `${currentTopic.innerPool.yesAmount} USDT`;
                if (noAmountEl) noAmountEl.textContent = `${currentTopic.innerPool.noAmount} USDT`;
            }

            // æ›´æ–°æˆ‘çš„æŒä»“
            updateMyPositions();

            // æ›´æ–°ä¸­é—´åŒºåŸŸçš„èµ„é‡‘æ± è¯¦æƒ…
            updatePoolDetailsSection();
        }

        // æ›´æ–°ä¸­é—´åŒºåŸŸçš„èµ„é‡‘æ± è¯¦æƒ…æ˜¾ç¤º
        function updatePoolDetailsSection() {
            if (!currentTopic) return;

            const poolDetailsSection = document.getElementById('poolDetailsSection');
            const isOuter = currentTopic.status === 'outer';

            if (isOuter && currentTopic.outerPool) {
                // å¤–ç›˜çŠ¶æ€ - æ˜¾ç¤ºå®Œæ•´çš„èµ„é‡‘æµå‘
                poolDetailsSection.innerHTML = `
                    <!-- å¤–ç›˜èµ„é‡‘æ±  -->
                    <div class="pool-section">
                        <div class="pool-section-header">
                            <span class="pool-section-title">å¤–ç›˜èµ„é‡‘æ± </span>
                            <span class="pool-section-badge outer">LMSR</span>
                        </div>
                        <div class="pool-info">
                            <div class="pool-row" style="color: #10b981;">
                                <span class="pool-label">æ¥è‡ªå†…ç›˜åº•æ± ï¼š</span>
                                <span class="pool-value">+${currentTopic.outerPool.basePool} USDT</span>
                            </div>
                            <div class="pool-row">
                                <span class="pool-label">YESäº¤æ˜“é‡ï¼š</span>
                                <span class="pool-value">${currentTopic.outerPool.yesAmount} USDT</span>
                            </div>
                            <div class="pool-row">
                                <span class="pool-label">NOäº¤æ˜“é‡ï¼š</span>
                                <span class="pool-value">${currentTopic.outerPool.noAmount} USDT</span>
                            </div>
                            <div class="pool-row">
                                <span class="pool-label">å¤–ç›˜æ€»é¢ï¼š</span>
                                <span class="pool-value">${currentTopic.outerPool.totalAmount} USDT</span>
                            </div>
                        </div>
                    </div>

                    <!-- å†…ç›˜èµ„é‡‘æ±  -->
                    <div class="pool-section">
                        <div class="pool-section-header">
                            <span class="pool-section-title">å†…ç›˜èµ„é‡‘æ± </span>
                            <span class="pool-section-badge pumped">å·²Pump</span>
                        </div>
                        <div class="pool-info">
                            <div class="pool-row">
                                <span class="pool-label">åŸå§‹YESæŠ•æ³¨ï¼š</span>
                                <span class="pool-value">${currentTopic.innerPool?.yesAmount || 0} USDT</span>
                            </div>
                            <div class="pool-row">
                                <span class="pool-label">åŸå§‹NOæŠ•æ³¨ï¼š</span>
                                <span class="pool-value">${currentTopic.innerPool?.noAmount || 0} USDT</span>
                            </div>
                            <div class="pool-row" style="color: #ef4444;">
                                <span class="pool-label">è½¬å‡ºå¤–ç›˜åº•æ± ï¼š</span>
                                <span class="pool-value">-${currentTopic.outerPool.basePool} USDT</span>
                            </div>
                            <div class="pool-row" style="color: #10b981;">
                                <span class="pool-label">æ‰‹çºŒè²»å›æµï¼š</span>
                                <span class="pool-value">+${currentTopic.outerPool.tradingFeeToInner || 0} USDT</span>
                            </div>
                            <div class="pool-row">
                                <span class="pool-label">å†…ç›˜å½“å‰æ€»é¢ï¼š</span>
                                <span class="pool-value">${((currentTopic.innerPool?.totalAmount || 0) - currentTopic.outerPool.basePool + (currentTopic.outerPool.tradingFeeToInner || 0)).toFixed(2)} USDT</span>
                            </div>
                        </div>
                    </div>

                    <!-- Pumpæœºåˆ¶è¯´æ˜ -->
                    <div style="background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3); border-radius: 8px; padding: 1rem; margin-top: 1rem; font-size: 0.85rem; color: #fbbf24;">
                        <strong>ğŸ’¡ Pumpæœºåˆ¶è¯´æ˜ï¼š</strong><br>
                        â€¢ å†…ç›˜è¾¾åˆ°1000Uæ—¶è§¦å‘Pump<br>
                        â€¢ å°æ–¹çš„50%è½¬å…¥å¤–ç›˜åº•æ± <br>
                        â€¢ å¤–ç›¤äº¤æ˜“æ‰‹çºŒè²»çš„40%æŒç»­å›æµå†…ç›˜
                    </div>
                `;
            } else {
                // å†…ç›˜çŠ¶æ€ - æ˜¾ç¤ºå½“å‰çŠ¶æ€å’ŒPumpè¿›åº¦
                const innerTotal = currentTopic.innerPool?.totalAmount || 0;
                const isPrivate = currentTopic.isPrivate;
                const pumpThreshold = currentTopic.pumpCondition || 1000;
                
                let progressSection = '';
                let conditionSection = '';
                
                if (!isPrivate) {
                    // éç§å¯†è©±é¡Œé¡¯ç¤ºPumpé€²åº¦
                    const progress = Math.min(innerTotal / pumpThreshold * 100, 100);
                    const remaining = Math.max(pumpThreshold - innerTotal, 0);
                    
                    progressSection = `
                        <div class="pump-progress" style="margin: 1.5rem 0;">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progress}%;"></div>
                            </div>
                            <div class="progress-text">
                                è·ç¦»Pumpè¿˜éœ€ <strong style="color: #10b981;">${remaining}</strong> USDT
                            </div>
                        </div>
                    `;
                    
                    conditionSection = `
                        <!-- Pumpæ¡ä»¶è¯´æ˜ -->
                        <div style="background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 8px; padding: 1rem; margin-top: 1rem; font-size: 0.85rem; color: #60a5fa;">
                            <strong>âš¡ Pumpæ¡ä»¶ï¼š</strong><br>
                            â€¢ å†…ç›˜èµ„é‡‘æ± è¾¾åˆ°${pumpThreshold} USDTæ—¶è‡ªåŠ¨è§¦å‘Pump<br>
                            â€¢ å†…ç›˜äº¤æ˜“æ”¶å–5%æ‰‹çºŒè²»<br>
                            â€¢ ä¸‹æ³¨é‡‘é¡è¾ƒå°ä¸€æ–¹çš„50%å°†è½¬ä¸ºå¤–ç›˜LMSRåº•æ± <br>
                            â€¢ è½¬ä¸ºå¤–ç›˜åå¯åœ¨ç€‘å¸ƒæµä¸­å±•ç¤ºå’Œäº¤æ˜“
                        </div>
                        
                        <!-- æ”¶ç›Šèªªæ˜ -->
                        <div style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 8px; padding: 1rem; margin-top: 1rem; font-size: 0.85rem; color: #10b981;">
                            <strong>ğŸ’° æ”¶ç›Šæ©Ÿæœƒï¼š</strong><br>
                            â€¢ <strong>å…§ç›¤å‹åˆ©</strong>ï¼šç“œåˆ†å°æ–¹é™£ç‡Ÿçš„å…¨éƒ¨è³‡é‡‘<br>
                            â€¢ <strong>å¤–ç›¤äº¤æ˜“</strong>ï¼šå¯åœ¨LMSRå¸‚å ´é€²è¡Œåƒ¹æ ¼äº¤æ˜“ç²åˆ©<br>
                            â€¢ <strong>æ‰‹çºŒè²»åˆ†ç´…</strong>ï¼šå…§ç›¤åƒèˆ‡è€…äº«å—å¤–ç›¤äº¤æ˜“æ‰‹çºŒè²»çš„40%å›æµ<br>
                            â€¢ <strong>æ—©æœŸåƒèˆ‡å„ªå‹¢</strong>ï¼šè¶Šæ—©åƒèˆ‡ï¼Œæ½›åœ¨æ”¶ç›Šå€æ•¸è¶Šé«˜
                        </div>
                    `;
                } else {
                    // ç§å¯†è©±é¡Œé¡¯ç¤ºç§å¯†èªªæ˜
                    conditionSection = `
                        <!-- ç§å¯†è©±é¡Œè¯´æ˜ -->
                        <div style="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; padding: 1rem; margin-top: 1rem; font-size: 0.85rem; color: #f87171;">
                            <strong>ğŸ”’ ç§å¯†è©±é¡Œï¼š</strong><br>
                            â€¢ æ­¤è©±é¡Œç‚ºç§å¯†è©±é¡Œï¼Œä¸æœƒå‡ºç¾åœ¨ç€‘å¸ƒæµä¸­<br>
                            â€¢ ç§å¯†è©±é¡Œä¸æ”¯æ´PumpåŠŸèƒ½ï¼Œä¸æœƒè½‰ç‚ºå¤–ç›¤<br>
                            â€¢ å…§ç›¤äº¤æ˜“æ”¶å–5%æ‰‹çºŒè²»<br>
                            â€¢ è©±é¡ŒçµæŸå¾Œç›´æ¥é€²è¡Œå…§ç›¤çµç®—
                        </div>
                    `;
                }

                poolDetailsSection.innerHTML = `
                    <!-- å†…ç›˜èµ„é‡‘æ±  -->
                    <div class="pool-section">
                        <div class="pool-section-header">
                            <span class="pool-section-title">å†…ç›¤è³‡é‡‘æ± </span>
                            <span class="pool-section-badge ${isPrivate ? 'private' : ''}">${isPrivate ? 'ç§å¯†' : 'æ´»èº'}</span>
                        </div>
                        <div class="pool-info">
                            <div class="pool-row">
                                <span class="pool-label">YESæŠ•æ³¨ï¼š</span>
                                <span class="pool-value">${currentTopic.innerPool?.yesAmount || 0} USDT</span>
                            </div>
                            <div class="pool-row">
                                <span class="pool-label">NOæŠ•æ³¨ï¼š</span>
                                <span class="pool-value">${currentTopic.innerPool?.noAmount || 0} USDT</span>
                            </div>
                            <div class="pool-row">
                                <span class="pool-label">å†…ç›¤ç¸½é¡ï¼š</span>
                                <span class="pool-value">${innerTotal} USDT</span>
                            </div>
                        </div>
                        ${progressSection}
                    </div>
                    ${conditionSection}
                `;
            }
        }

        // æ›´æ–°PKç•Œé¢æ•¸æ“š
        function updatePKInterface() {
            if (!currentTopic || !currentTopic.innerPool) return;
            
            const { yesAmount, noAmount, totalAmount } = currentTopic.innerPool;
            
            // è¨ˆç®—ç™¾åˆ†æ¯”
            const yesPercentage = totalAmount > 0 ? Math.round((yesAmount / totalAmount) * 100) : 0;
            const noPercentage = totalAmount > 0 ? Math.round((noAmount / totalAmount) * 100) : 0;
            
            // æ¨¡æ“¬åƒèˆ‡äººæ•¸ï¼ˆå¯¦éš›é …ç›®ä¸­éœ€è¦å¾å¾Œç«¯ç²å–ï¼‰
            const yesParticipants = Math.floor(yesAmount / 50) + Math.floor(Math.random() * 5);
            const noParticipants = Math.floor(noAmount / 50) + Math.floor(Math.random() * 5);
            
            // æ›´æ–°YESé™£ç‡Ÿæ•¸æ“š
            document.getElementById('yesAmount').textContent = `${yesAmount} USDT`;
            document.getElementById('yesPercentage').textContent = `${yesPercentage}%`;
            document.getElementById('yesParticipants').textContent = `${yesParticipants}äºº`;
            
            // æ›´æ–°NOé™£ç‡Ÿæ•¸æ“š
            document.getElementById('noAmount').textContent = `${noAmount} USDT`;
            document.getElementById('noPercentage').textContent = `${noPercentage}%`;
            document.getElementById('noParticipants').textContent = `${noParticipants}äºº`;
            
            // æ›´æ–°é€²åº¦æŒ‡ç¤ºå™¨
            const yesIndicator = document.getElementById('yesIndicator');
            const noIndicator = document.getElementById('noIndicator');
            
            if (yesIndicator) yesIndicator.style.width = `${yesPercentage}%`;
            if (noIndicator) noIndicator.style.width = `${noPercentage}%`;
            
            // æ›´æ–°é¸ä¸­ç‹€æ…‹
            const yesSide = document.querySelector('.yes-side');
            const noSide = document.querySelector('.no-side');
            
            if (selectedOption === 'yes') {
                yesSide?.classList.add('selected');
                noSide?.classList.remove('selected');
            } else if (selectedOption === 'no') {
                noSide?.classList.add('selected');
                yesSide?.classList.remove('selected');
            } else {
                yesSide?.classList.remove('selected');
                noSide?.classList.remove('selected');
            }
        }

        // æ›´æ–°æˆ‘çš„æŒä»“æ˜¾ç¤º
        function updateMyPositions() {
            if (!currentTopic) return;

            const isOuter = currentTopic.status === 'outer';
            const myInnerPositions = document.getElementById('myInnerPositions');
            const myOuterPositions = document.getElementById('myOuterPositions');

            // æ›´æ–°å…§ç›¤æŒå€‰
            document.getElementById('myInnerYes').textContent = `${currentTopic.myInnerYes || 0} USDT`;
            document.getElementById('myInnerNo').textContent = `${currentTopic.myInnerNo || 0} USDT`;

            // æ ¹æ®çŠ¶æ€æ˜¾ç¤º/éšè—å¤–ç›¤æŒå€‰
            if (isOuter && currentTopic.outerPool) {
                myOuterPositions.style.display = 'block';
                
                // æ›´æ–°å¤–ç›¤æŒå€‰
                const myOuterYes = currentTopic.myOuterYes || 0;
                const myOuterNo = currentTopic.myOuterNo || 0;
                document.getElementById('myOuterYes').textContent = `${myOuterYes} ä¸ª`;
                document.getElementById('myOuterNo').textContent = `${myOuterNo} ä¸ª`;

                // è®¡ç®—å¤–ç›¤æŒå€‰ä¼°å€¼
                if (currentTopic.outerPool.totalAmount > 0) {
                    const yesPrice = currentTopic.outerPool.yesAmount / currentTopic.outerPool.totalAmount;
                    const noPrice = currentTopic.outerPool.noAmount / currentTopic.outerPool.totalAmount;
                    const totalValue = (myOuterYes * yesPrice + myOuterNo * noPrice).toFixed(2);
                    document.getElementById('myOuterValue').textContent = `${totalValue} USDT`;
                } else {
                    document.getElementById('myOuterValue').textContent = '0 USDT';
                }
            } else {
                myOuterPositions.style.display = 'none';
            }
        }

        // é¸æ“‡ä¸‹æ³¨é¸é …
        function selectOption(option) {
            selectedOption = option;
            document.querySelectorAll('.bet-option').forEach(el => {
                el.classList.remove('selected');
            });
            document.querySelector(`.bet-option.${option}`).classList.add('selected');
        }

        // ä¸‹æ³¨
        function placeBet() {
            if (!selectedOption) {
                alert('è¯·å…ˆé¸æ“‡YESæˆ–NO');
                return;
            }

            const amount = parseInt(document.getElementById('betAmount').value);
            if (!amount || amount <= 0) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„ä¸‹æ³¨é‡‘é¡');
                return;
            }

            // æ˜¾ç¤ºç¢ºèªæ¨¡æ€æ¡†
            document.getElementById('confirmText').textContent = 
                `æ‚¨ç¡®å®šè¦ä¸‹æ³¨ ${amount} USDT åˆ° ${selectedOption.toUpperCase()} å—ï¼Ÿ`;
            document.getElementById('confirmModal').classList.add('active');
        }

        // ç¢ºèªä¸‹æ³¨
        function confirmBet() {
            const inputAmount = parseInt(document.getElementById('betAmount').value);
            
            // è¨ˆç®—5%æ‰‹çºŒè²»
            const fee = inputAmount * 0.05;
            const netAmount = inputAmount - fee;
            
            // ç¢ºèªäº¤æ˜“
            if (!confirm(`ç¢ºèªä¸‹æ³¨ ${inputAmount} USDTï¼Ÿ\næ‰‹çºŒè²»: ${fee.toFixed(2)} USDT (5%)\nå¯¦éš›ä¸‹æ³¨: ${netAmount.toFixed(2)} USDT`)) {
                return;
            }
            
            // ç¡®ä¿å†…ç›˜æ•°æ®ç»“æ„å­˜åœ¨
            if (!currentTopic.innerPool) {
                currentTopic.innerPool = { yesAmount: 0, noAmount: 0, totalAmount: 0 };
            }
            
            // æ›´æ–°å†…ç›˜æ•°æ®ï¼ˆä½¿ç”¨æ‰£é™¤æ‰‹çºŒè²»å¾Œçš„é‡‘é¡ï¼‰
            if (selectedOption === 'yes') {
                currentTopic.innerPool.yesAmount += netAmount;
                currentTopic.myInnerYes = (currentTopic.myInnerYes || 0) + netAmount;
            } else {
                currentTopic.innerPool.noAmount += netAmount;
                currentTopic.myInnerNo = (currentTopic.myInnerNo || 0) + netAmount;
            }
            currentTopic.innerPool.totalAmount += netAmount;

            // æ›´æ–°sampleTopicsä¸­çš„æ•°æ®
            const topicIndex = sampleTopics.findIndex(t => t.id === currentTopic.id);
            if (topicIndex !== -1) {
                sampleTopics[topicIndex] = {...currentTopic};
            }

            // æ£€æŸ¥æ˜¯å¦è§¦å‘Pumpï¼ˆä½¿ç”¨è‡ªå®šç¾©æ¢ä»¶ï¼Œç§å¯†è©±é¡Œä¸è§¸ç™¼ï¼‰
            const pumpThreshold = currentTopic.pumpCondition || 1000;
            if (currentTopic.innerPool.totalAmount >= pumpThreshold && 
                currentTopic.status === 'inner' && 
                !currentTopic.isPrivate) {
                triggerPump();
            } else {
                // å¦‚æœè¿˜æ˜¯å†…ç›˜ï¼Œæ›´æ–°ç•Œé¢æç¤º
                updateTradingInterface();
            }

            updatePoolDisplay();
            closeModal();
            
            // æ¸…ç©ºè¼¸å…¥
            document.getElementById('betAmount').value = '';
            selectedOption = null;
            document.querySelectorAll('.bet-option').forEach(el => {
                el.classList.remove('selected');
            });
        }

        // è§¦å‘Pumpæœºåˆ¶
        function triggerPump() {
            const inner = currentTopic.innerPool;
            
            // æ‰¾å‡ºä¸‹æ³¨é‡‘é¡è¾ƒå°çš„ä¸€æ–¹
            const smallerSide = inner.yesAmount < inner.noAmount ? 'yes' : 'no';
            const smallerAmount = Math.min(inner.yesAmount, inner.noAmount);
            
            // å°æ–¹çš„50%ä½œä¸ºå¤–ç›˜åº•æ± 
            const basePool = smallerAmount * 0.5;
            
            // æ ¹æ®å†…ç›˜èµ„é‡‘æ¯”ä¾‹è®¾ç½®åˆå§‹è™šæ‹ŸæµåŠ¨æ€§
            const yesRatio = inner.yesAmount / inner.totalAmount;
            const noRatio = inner.noAmount / inner.totalAmount;
            
            // åˆ›å»ºå¤–ç›˜æ•°æ®ç»“æ„
            currentTopic.outerPool = {
                basePool: basePool,
                yesAmount: yesRatio * basePool * 2, // åˆå§‹è™šæ‹ŸæµåŠ¨æ€§
                noAmount: noRatio * basePool * 2,
                totalAmount: basePool * 2,
                tradingFeeToInner: 0
            };
            
            // æ›´æ–°çŠ¶æ€
            currentTopic.status = 'outer';
            currentTopic.isOuter = true;
            
            // æ›´æ–°sampleTopicsä¸­çš„æ•°æ®
            const topicIndex = sampleTopics.findIndex(t => t.id === currentTopic.id);
            if (topicIndex !== -1) {
                sampleTopics[topicIndex] = {...currentTopic};
            }
            
            // æ›´æ–°äº¤æ˜“ç•Œé¢
            updateTradingInterface();
            
            // æ˜¾ç¤ºPumpé€šçŸ¥
            setTimeout(() => {
                document.getElementById('pumpModal').classList.add('active');
            }, 500);
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
            document.getElementById('confirmModal').classList.remove('active');
        }

        function closePumpModal() {
            document.getElementById('pumpModal').classList.remove('active');
            // åˆ‡æ¢åˆ°å¤–ç›¤äº¤æ˜“ç•Œé¢
            document.getElementById('innerTrading').style.display = 'none';
            document.getElementById('outerTrading').style.display = 'block';
            document.getElementById('tradingTitle').textContent = 'LMSRäº¤æ˜“';
            document.getElementById('tradingSubtitle').textContent = 'åŸºäºå¸‚åœºåƒ¹æ ¼äº¤æ˜“';
        }

        // åˆ†äº«é€£çµ
        function shareLink() {
            const url = `${window.location.origin}${window.location.pathname}?topic=${currentTopic.id}`;
            navigator.clipboard.writeText(url).then(() => {
                alert('åˆ†äº«é€£çµå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            });
        }

        // è‡ªå®šä¹‰é€‰é¡¹ç®¡ç†
        // åˆ‡æ›é¸é …é¡å‹
        function toggleOptionType() {
            const optionType = document.querySelector('input[name="optionType"]:checked').value;
            const customOptions = document.getElementById('customOptions');
            
            if (optionType === 'custom') {
                customOptions.style.display = 'block';
                // åˆå§‹åŒ–2å€‹é»˜èªé¸é …
                if (document.getElementById('optionsList').children.length === 0) {
                    addOption();
                    addOption();
                }
            } else {
                customOptions.style.display = 'none';
                // æ¸…ç©ºè‡ªå®šç¾©é¸é …
                document.getElementById('optionsList').innerHTML = '';
            }
        }

        function addOption() {
            const optionsList = document.getElementById('optionsList');
            const currentCount = optionsList.children.length;
            
            // æœ€å¤š8å€‹é¸é …
            if (currentCount >= 8) {
                alert('æœ€å¤šåªèƒ½æ·»åŠ 8å€‹é¸é …');
                return;
            }
            
            const optionDiv = document.createElement('div');
            optionDiv.className = 'option-input';
            optionDiv.innerHTML = `
                <span class="option-number">é¸é … ${currentCount + 1}:</span>
                <input type="text" class="form-input" name="customOption${currentCount + 1}" placeholder="è¼¸å…¥é¸é …åç¨±" required>
                <button type="button" class="btn btn-secondary btn-sm" onclick="removeOption(this)">åˆªé™¤</button>
            `;
            optionsList.appendChild(optionDiv);
            
            updateRemoveButtons();
        }

        function removeOption(button) {
            const optionsList = document.getElementById('optionsList');
            const currentCount = optionsList.children.length;
            
            // è‡³å°‘ä¿ç•™2å€‹é¸é …
            if (currentCount <= 2) {
                alert('è‡³å°‘éœ€è¦ä¿ç•™2å€‹é¸é …');
                return;
            }
            
            button.parentElement.remove();
            updateOptionNumbers();
            updateRemoveButtons();
        }

        function updateOptionNumbers() {
            const optionsList = document.getElementById('optionsList');
            const options = optionsList.children;
            
            for (let i = 0; i < options.length; i++) {
                const numberSpan = options[i].querySelector('.option-number');
                const input = options[i].querySelector('input');
                numberSpan.textContent = `é¸é … ${i + 1}:`;
                input.name = `customOption${i + 1}`;
            }
        }

        function updateRemoveButtons() {
            const optionsList = document.getElementById('optionsList');
            const removeButtons = optionsList.querySelectorAll('.btn-secondary');
            const currentCount = optionsList.children.length;
            
            // ç•¶åªæœ‰2å€‹é¸é …æ™‚ç¦ç”¨åˆªé™¤æŒ‰éˆ•
            removeButtons.forEach(button => {
                if (currentCount <= 2) {
                    button.disabled = true;
                    button.style.opacity = '0.5';
                } else {
                    button.disabled = false;
                    button.style.opacity = '1';
                }
            });
        }

        // åˆ‡æ›Pumpè¨­å®šçš„å¯ç”¨æ€§
        function togglePumpSettings() {
            const isPrivate = document.getElementById('isPrivate').checked;
            const pumpSection = document.getElementById('pumpSection');
            
            if (isPrivate) {
                pumpSection.classList.add('disabled');
                // ç¦ç”¨Pumpè¨­å®šä¸­çš„è¼¸å…¥
                const pumpInput = document.querySelector('input[name="pumpCondition"]');
                if (pumpInput) pumpInput.disabled = true;
            } else {
                pumpSection.classList.remove('disabled');
                // å•Ÿç”¨Pumpè¨­å®šä¸­çš„è¼¸å…¥
                const pumpInput = document.querySelector('input[name="pumpCondition"]');
                if (pumpInput) pumpInput.disabled = false;
            }
        }

        // åˆ‡æ›é«˜ç´šè¨­å®šçš„é¡¯ç¤º
        function toggleAdvancedSettings() {
            const showAdvanced = document.getElementById('showAdvanced').checked;
            const advancedSettings = document.getElementById('advancedSettings');
            
            if (showAdvanced) {
                advancedSettings.style.display = 'block';
            } else {
                advancedSettings.style.display = 'none';
                // æ¸…ç©ºé«˜ç´šè¨­å®šçš„å€¼
                const outerTradingEndTime = document.querySelector('input[name="outerTradingEndTime"]');
                if (outerTradingEndTime) outerTradingEndTime.value = '';
            }
        }

        // ç•¶è©±é¡ŒçµæŸæ™‚é–“æ”¹è®Šæ™‚ï¼Œæ›´æ–°å¤–ç›¤äº¤æ˜“çµæŸæ™‚é–“çš„é»˜èªå€¼
        function updateAdvancedSettings() {
            const topicEndTime = document.querySelector('input[name="topicEndTime"]').value;
            const outerTradingEndTime = document.querySelector('input[name="outerTradingEndTime"]');
            
            if (outerTradingEndTime && !outerTradingEndTime.value) {
                outerTradingEndTime.value = topicEndTime;
            }
        }

        // Kç·šåœ–ç›¸é—œåŠŸèƒ½
        let currentTimeframe = '1m';
        let klineData = [];
        let chartInterval = null;

        // åˆå§‹åŒ–Kç·šåœ–
        function initKlineChart() {
            if (!currentTopic || currentTopic.status !== 'outer') return;
            
            // ç”Ÿæˆæ¨¡æ“¬Kç·šæ•¸æ“š
            generateKlineData();
            renderKlineChart();
            
            // å•Ÿå‹•å¯¦æ™‚æ›´æ–°
            if (chartInterval) clearInterval(chartInterval);
            chartInterval = setInterval(() => {
                updateKlineData();
                renderKlineChart();
            }, 2000); // æ¯2ç§’æ›´æ–°ä¸€æ¬¡
        }

        // ç”Ÿæˆæ¨¡æ“¬Kç·šæ•¸æ“š
        function generateKlineData() {
            const { yesAmount, noAmount } = currentTopic.outerPool;
            const totalAmount = yesAmount + noAmount;
            const basePrice = totalAmount > 0 ? yesAmount / totalAmount : 0.5;
            
            klineData = [];
            const now = Date.now();
            const barCount = 30; // é¡¯ç¤º30æ ¹Kç·š
            
            for (let i = barCount - 1; i >= 0; i--) {
                const timestamp = now - i * 60000; // æ¯åˆ†é˜ä¸€æ ¹Kç·š
                const variation = (Math.random() - 0.5) * 0.1; // Â±5%è®Šå‹•
                const price = Math.max(0.1, Math.min(0.9, basePrice + variation));
                
                const open = i === barCount - 1 ? basePrice : klineData[klineData.length - 1]?.close || price;
                const high = Math.max(open, price + Math.random() * 0.05);
                const low = Math.min(open, price - Math.random() * 0.05);
                const close = price;
                
                klineData.push({
                    timestamp,
                    open: Math.max(0.1, Math.min(0.9, open)),
                    high: Math.max(0.1, Math.min(0.9, high)),
                    low: Math.max(0.1, Math.min(0.9, low)),
                    close: Math.max(0.1, Math.min(0.9, close)),
                    volume: Math.floor(Math.random() * 1000) + 100
                });
            }
        }

        // æ›´æ–°Kç·šæ•¸æ“š
        function updateKlineData() {
            if (klineData.length === 0) return;
            
            const lastBar = klineData[klineData.length - 1];
            const variation = (Math.random() - 0.5) * 0.02; // Â±1%è®Šå‹•
            const newClose = Math.max(0.1, Math.min(0.9, lastBar.close + variation));
            
            // æ›´æ–°æœ€å¾Œä¸€æ ¹Kç·š
            klineData[klineData.length - 1] = {
                ...lastBar,
                high: Math.max(lastBar.high, newClose),
                low: Math.min(lastBar.low, newClose),
                close: newClose,
                volume: lastBar.volume + Math.floor(Math.random() * 50)
            };
            
            // æœ‰æ™‚å€™æ·»åŠ æ–°çš„Kç·š
            if (Math.random() < 0.1) {
                const newBar = {
                    timestamp: Date.now(),
                    open: newClose,
                    high: newClose + Math.random() * 0.02,
                    low: newClose - Math.random() * 0.02,
                    close: newClose,
                    volume: Math.floor(Math.random() * 500) + 50
                };
                
                klineData.push(newBar);
                if (klineData.length > 30) {
                    klineData.shift(); // ä¿æŒ30æ ¹Kç·š
                }
            }
        }

        // æ¸²æŸ“Kç·šåœ–
        function renderKlineChart() {
            const chartContainer = document.getElementById('centerKlineChart');
            if (!chartContainer || klineData.length === 0) return;
            
            // æ¸…ç©ºç¾æœ‰å…§å®¹
            chartContainer.innerHTML = '';
            
            // è¨ˆç®—åƒ¹æ ¼ç¯„åœ
            const prices = klineData.flatMap(d => [d.high, d.low]);
            const minPrice = Math.min(...prices);
            const maxPrice = Math.max(...prices);
            const priceRange = maxPrice - minPrice || 0.1;
            
            const chartWidth = chartContainer.clientWidth - 32;
            const chartHeight = 248;
            const barWidth = chartWidth / klineData.length * 0.8;
            
            // æ¸²æŸ“Kç·š
            klineData.forEach((bar, index) => {
                const x = (index + 0.5) * (chartWidth / klineData.length);
                const isUp = bar.close > bar.open;
                
                // è¨ˆç®—ä½ç½®
                const bodyTop = ((maxPrice - Math.max(bar.open, bar.close)) / priceRange) * chartHeight;
                const bodyHeight = Math.abs(bar.close - bar.open) / priceRange * chartHeight || 1;
                const wickTop = ((maxPrice - bar.high) / priceRange) * chartHeight;
                const wickBottom = ((maxPrice - bar.low) / priceRange) * chartHeight;
                
                // å‰µå»ºKç·šæŸ±
                const barElement = document.createElement('div');
                barElement.className = `kline-bar ${isUp ? 'up' : 'down'}`;
                barElement.style.left = `${x - barWidth/2}px`;
                barElement.style.width = `${barWidth}px`;
                barElement.style.height = `${bodyHeight}px`;
                barElement.style.bottom = `${chartHeight - bodyTop - bodyHeight + 16}px`;
                
                // æ·»åŠ æ‡¸åœäº‹ä»¶
                barElement.addEventListener('mouseenter', (e) => showTooltip(e, bar));
                barElement.addEventListener('mouseleave', hideTooltip);
                
                chartContainer.appendChild(barElement);
                
                // æ·»åŠ ä¸Šä¸‹å½±ç·š
                if (bar.high !== Math.max(bar.open, bar.close)) {
                    const wickUpElement = document.createElement('div');
                    wickUpElement.style.position = 'absolute';
                    wickUpElement.style.left = `${x - 0.5}px`;
                    wickUpElement.style.width = '1px';
                    wickUpElement.style.height = `${bodyTop - wickTop}px`;
                    wickUpElement.style.bottom = `${chartHeight - wickTop + 16}px`;
                    wickUpElement.style.background = isUp ? '#10b981' : '#ef4444';
                    chartContainer.appendChild(wickUpElement);
                }
                
                if (bar.low !== Math.min(bar.open, bar.close)) {
                    const wickDownElement = document.createElement('div');
                    wickDownElement.style.position = 'absolute';
                    wickDownElement.style.left = `${x - 0.5}px`;
                    wickDownElement.style.width = '1px';
                    wickDownElement.style.height = `${wickBottom - bodyTop - bodyHeight}px`;
                    wickDownElement.style.bottom = `${16}px`;
                    wickDownElement.style.background = isUp ? '#10b981' : '#ef4444';
                    chartContainer.appendChild(wickDownElement);
                }
            });
            
            // æ·»åŠ ç•¶å‰åƒ¹æ ¼æŒ‡ç¤ºå™¨
            const currentPrice = klineData[klineData.length - 1]?.close || 0.5;
            const priceY = ((maxPrice - currentPrice) / priceRange) * chartHeight;
            
            const priceIndicator = document.createElement('div');
            priceIndicator.className = 'price-indicator';
            priceIndicator.style.top = `${priceY}px`;
            priceIndicator.textContent = currentPrice.toFixed(3);
            chartContainer.appendChild(priceIndicator);
        }

        // é¡¯ç¤ºå·¥å…·æç¤º
        function showTooltip(event, bar) {
            let tooltip = document.querySelector('.chart-tooltip');
            if (!tooltip) {
                tooltip = document.createElement('div');
                tooltip.className = 'chart-tooltip';
                document.body.appendChild(tooltip);
            }
            
            const time = new Date(bar.timestamp).toLocaleTimeString();
            tooltip.innerHTML = `
                <div>æ™‚é–“: ${time}</div>
                <div>é–‹: ${bar.open.toFixed(3)}</div>
                <div>é«˜: ${bar.high.toFixed(3)}</div>
                <div>ä½: ${bar.low.toFixed(3)}</div>
                <div>æ”¶: ${bar.close.toFixed(3)}</div>
                <div>é‡: ${bar.volume}</div>
            `;
            
            tooltip.style.left = `${event.pageX + 10}px`;
            tooltip.style.top = `${event.pageY - 10}px`;
            tooltip.style.opacity = '1';
        }

        // éš±è—å·¥å…·æç¤º
        function hideTooltip() {
            const tooltip = document.querySelector('.chart-tooltip');
            if (tooltip) {
                tooltip.style.opacity = '0';
            }
        }

        // åˆ‡æ›æ™‚é–“æ¡†æ¶
        function switchTimeframe(timeframe) {
            currentTimeframe = timeframe;
            
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.chart-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // é‡æ–°ç”Ÿæˆæ•¸æ“š
            generateKlineData();
            renderKlineChart();
        }

        // å‰µå»ºè©±é¡Œè¡¨å•æäº¤
        document.getElementById('createTopicForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const isPrivate = formData.get('isPrivate') === 'on';
            const pumpCondition = parseInt(formData.get('pumpCondition')) || 1000;
            
            // è™•ç†é ­åƒ - å¦‚æœæ˜¯æ–‡ä»¶å‰‡é¡¯ç¤ºæ–‡ä»¶åï¼Œå¦å‰‡ä½¿ç”¨é¦–å­—ç¬¦
            let avatar;
            const avatarFile = formData.get('avatar');
            if (avatarFile && avatarFile.name) {
                avatar = 'ğŸ“·'; // ä½¿ç”¨ç›¸æ©Ÿemojiè¡¨ç¤ºå·²ä¸Šå‚³åœ–ç‰‡
            } else {
                avatar = formData.get('content').charAt(0).toUpperCase();
            }
            
            const newTopic = {
                id: Date.now(),
                title: formData.get('content'),
                category: formData.get('category'),
                categoryName: e.target.category.selectedOptions[0].text,
                avatar: avatar,
                innerPool: {
                    yesAmount: 0,
                    noAmount: 0,
                    totalAmount: 0
                },
                outerPool: null,
                isOuter: false,
                endTime: formData.get('topicEndTime').split('T')[0],
                tradingEndTime: formData.get('tradingEndTime'), // å…§ç›¤äº¤æ˜“çµæŸæ™‚é–“
                status: 'inner',
                description: formData.get('content'),
                isPrivate: isPrivate,
                pumpCondition: isPrivate ? null : pumpCondition, // ç§å¯†è©±é¡Œä¸è¨­å®šPumpæ¢ä»¶
                outerTradingEndTime: formData.get('outerTradingEndTime') || formData.get('topicEndTime'), // é«˜ç´šè¨­å®š
                myInnerYes: 0,
                myInnerNo: 0,
                myOuterYes: 0,
                myOuterNo: 0
            };

            sampleTopics.push(newTopic);
            alert('è¯é¢˜åˆ›å»ºæˆåŠŸï¼');
            
            // é‡ç½®è¡¨å•
            e.target.reset();
            
            // è·³è½¬åˆ°è©±é¡Œè©³æƒ…
            showTopicDetail(newTopic.id);
        });

        // æ¸²æŸ“å€‹äººä¸­å¿ƒæ•°æ®
        function renderProfileData() {
            // è®¡ç®—ç»Ÿè®¡æ•°æ®
            let totalInvested = 0;  // ç¸½æŠ•å…¥
            let totalValue = 0;     // æŒå€‰åƒ¹å€¼
            let participatedTopics = 0;  // åƒèˆ‡è©±é¡Œæ•¸
            let totalTradingVolume = 0;  // ç¸½äº¤æ˜“é‡

            sampleTopics.forEach(topic => {
                const myInnerYes = topic.myInnerYes || 0;
                const myInnerNo = topic.myInnerNo || 0;
                const myOuterYes = topic.myOuterYes || 0;
                const myOuterNo = topic.myOuterNo || 0;
                
                const myInnerTotal = myInnerYes + myInnerNo;
                const myOuterTotal = myOuterYes + myOuterNo;
                const myTotal = myInnerTotal + myOuterTotal;
                
                if (myTotal > 0) {
                    participatedTopics++;
                    totalInvested += myTotal;
                    
                    // è¨ˆç®—ç•¶å‰æŒå€‰åƒ¹å€¼
                    let currentValue = myInnerTotal; // å…§ç›¤æŒ‰åŸå€¼è¨ˆç®—
                    
                    // è¨ˆç®—äº¤æ˜“é‡ï¼ˆåŒ…æ‹¬å…§ç›¤å’Œå¤–ç›¤çš„æ‰€æœ‰äº¤æ˜“ï¼‰
                    totalTradingVolume += myInnerTotal; // å…§ç›¤æŠ•å…¥
                    
                    if (topic.status === 'outer' && topic.outerPool && topic.outerPool.totalAmount > 0) {
                        const yesPrice = topic.outerPool.yesAmount / topic.outerPool.totalAmount;
                        const noPrice = topic.outerPool.noAmount / topic.outerPool.totalAmount;
                        const outerValue = myOuterYes * yesPrice + myOuterNo * noPrice;
                        currentValue = myInnerTotal + outerValue;
                        
                        // å¤–ç›¤äº¤æ˜“é‡ä¼°ç®—ï¼ˆå‡è¨­ä»£å¹£æ˜¯ä»¥ç•¶å‰åƒ¹æ ¼è²·å…¥çš„ï¼‰
                        const outerTradeValue = myOuterYes * yesPrice + myOuterNo * noPrice;
                        totalTradingVolume += outerTradeValue;
                        
                        // æ¨¡æ“¬æ­·å²äº¤æ˜“é‡ï¼ˆç‚ºäº†é”åˆ°30Mçš„æ°´å¹³ï¼‰
                        totalTradingVolume += topic.outerPool.totalAmount * 0.1; // å‡è¨­åƒèˆ‡äº†ç¸½æ± çš„10%çš„äº¤æ˜“
                    }
                    
                    // ç‚ºæ¯å€‹è©±é¡Œæ·»åŠ æ¨¡æ“¬çš„æ­·å²äº¤æ˜“é‡
                    totalTradingVolume += (topic.innerPool?.totalAmount || 0) * 2; // æ¨¡æ“¬å¤šæ¬¡å…§ç›¤äº¤æ˜“
                    
                    totalValue += currentValue;
                }
            });

            // æ¨¡æ“¬æ›´å¤§çš„äº¤æ˜“é‡ä»¥é”åˆ°åˆç†çš„æ•¸å€¼
            totalTradingVolume = totalTradingVolume * 50000; // æ”¾å¤§å€æ•¸ä»¥é”åˆ°30Mç´šåˆ¥

            const totalProfit = totalValue - totalInvested;

            // æ ¼å¼åŒ–æ•¸å­—é¡¯ç¤º
            const formatNumber = (num) => {
                if (num >= 1000000) {
                    return (num / 1000000).toFixed(1) + 'M';
                } else if (num >= 1000) {
                    return (num / 1000).toFixed(1) + 'K';
                } else {
                    return num.toFixed(2);
                }
            };

            // æ›´æ–°çµ±è¨ˆæ•¸æ“š
            document.getElementById('totalAssets').textContent = `${formatNumber(totalValue)} U`;
            document.getElementById('totalProfit').textContent = totalProfit >= 0 ? 
                `+${formatNumber(totalProfit)} U` : `${formatNumber(totalProfit)} U`;
            document.getElementById('totalTopics').textContent = participatedTopics;
            document.getElementById('totalTrades').textContent = `${formatNumber(totalTradingVolume)} U`;

            // æ¸²æŸ“ç•¶å‰æŒå€‰
            renderCurrentPositions();
            
            // æ¸²æŸ“äº¤æ˜“æ­·å²
            renderTradingHistory();
        }

        // æ¸²æŸ“ç•¶å‰æŒå€‰
        function renderCurrentPositions() {
            const container = document.getElementById('currentPositions');
            container.innerHTML = '';

            const activePositions = sampleTopics.filter(topic => {
                const myInnerTotal = (topic.myInnerYes || 0) + (topic.myInnerNo || 0);
                const myOuterTotal = (topic.myOuterYes || 0) + (topic.myOuterNo || 0);
                return (myInnerTotal > 0 || myOuterTotal > 0) && topic.status !== 'ended';
            });

            if (activePositions.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“Š</div>
                        <p>æš«ç„¡æ´»è·ƒæŒä»“</p>
                        <p style="font-size: 0.8rem; margin-top: 0.5rem;">åƒèˆ‡è©±é¡Œäº¤æ˜“åå°†åœ¨è¿™é‡Œæ˜¾ç¤º</p>
                    </div>
                `;
                return;
            }

            activePositions.forEach(topic => {
                const myInnerYes = topic.myInnerYes || 0;
                const myInnerNo = topic.myInnerNo || 0;
                const myOuterYes = topic.myOuterYes || 0;
                const myOuterNo = topic.myOuterNo || 0;
                
                const myInnerTotal = myInnerYes + myInnerNo;
                const myOuterTotal = myOuterYes + myOuterNo;
                const myTotal = myInnerTotal + myOuterTotal;
                
                // ç¡®å®šä¸»è¦æŒä»“ç±»å‹å’Œé‡‘é¢
                let position, positionAmount, positionType;
                if (myInnerTotal > myOuterTotal) {
                    position = myInnerYes > myInnerNo ? 'YES' : 'NO';
                    positionAmount = Math.max(myInnerYes, myInnerNo);
                    positionType = 'å†…ç›˜';
                } else if (myOuterTotal > 0) {
                    position = myOuterYes > myOuterNo ? 'YES' : 'NO';
                    positionAmount = Math.max(myOuterYes, myOuterNo);
                    positionType = 'å¤–ç›˜';
                } else {
                    position = myInnerYes > myInnerNo ? 'YES' : 'NO';
                    positionAmount = Math.max(myInnerYes, myInnerNo);
                    positionType = 'å†…ç›˜';
                }

                // è®¡ç®—å½“å‰ä»·å€¼
                let currentValue = myInnerTotal;
                let valueClass = 'neutral';
                if (topic.status === 'outer' && topic.outerPool && topic.outerPool.totalAmount > 0) {
                    const yesPrice = topic.outerPool.yesAmount / topic.outerPool.totalAmount;
                    const noPrice = topic.outerPool.noAmount / topic.outerPool.totalAmount;
                    const outerValue = myOuterYes * yesPrice + myOuterNo * noPrice;
                    currentValue = myInnerTotal + outerValue;
                    valueClass = currentValue > myTotal ? 'positive' : currentValue < myTotal ? 'negative' : 'neutral';
                }

                const profitLoss = currentValue - myTotal;

                container.innerHTML += `
                    <div class="position-item" onclick="showTopicDetail(${topic.id})">
                        <div class="position-info">
                            <div class="position-title">${topic.title}</div>
                            <div class="position-details">
                                <span>æŒä»“ï¼š${position} ${positionAmount} ${positionType === 'å¤–ç›˜' ? 'ä¸ª' : 'USDT'}</span>
                                <span>çŠ¶æ€ï¼š${positionType}</span>
                                <span>ç»“æŸï¼š${topic.endTime}</span>
                            </div>
                        </div>
                        <div class="position-value">
                            <div class="position-amount ${valueClass}">${currentValue.toFixed(2)} USDT</div>
                            <div class="position-status status-active">
                                ${profitLoss >= 0 ? '+' : ''}${profitLoss.toFixed(2)}
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        // æ¸²æŸ“äº¤æ˜“æ­·å²
        function renderTradingHistory() {
            const container = document.getElementById('tradingHistory');
            
            // æ¨¡æ‹Ÿäº¤æ˜“æ­·å²æ•°æ®
            const historyData = [
                {
                    id: 1,
                    title: "æ¯”ç‰¹å¸åƒ¹æ ¼é¢„æµ‹",
                    position: "YES",
                    amount: 100,
                    result: "won",
                    profit: 45.5,
                    date: "2024-01-15"
                },
                {
                    id: 2,
                    title: "ç¾å›½å¤§é€‰é¢„æµ‹",
                    position: "NO",
                    amount: 200,
                    result: "won",
                    profit: 89.2,
                    date: "2024-01-10"
                },
                {
                    id: 3,
                    title: "ç‰¹æ–¯æ‹‰è‚¡ä»·é¢„æµ‹",
                    position: "YES",
                    amount: 150,
                    result: "lost",
                    profit: -150,
                    date: "2024-01-05"
                },
                {
                    id: 4,
                    title: "OpenAIç™¼å¸ƒé¢„æµ‹",
                    position: "NO",
                    amount: 80,
                    result: "won",
                    profit: 25.8,
                    date: "2023-12-28"
                }
            ];

            container.innerHTML = '';

            historyData.forEach(trade => {
                const resultClass = trade.result === 'won' ? 'positive' : 'negative';
                const statusClass = trade.result === 'won' ? 'status-won' : 'status-lost';

                container.innerHTML += `
                    <div class="history-item">
                        <div class="history-info">
                            <div class="history-title">${trade.title}</div>
                            <div class="history-details">
                                <span>æŒä»“ï¼š${trade.position} ${trade.amount} USDT</span>
                                <span>æ—¥æœŸï¼š${trade.date}</span>
                            </div>
                        </div>
                        <div class="history-value">
                            <div class="history-amount ${resultClass}">
                                ${trade.profit >= 0 ? '+' : ''}${trade.profit.toFixed(2)} USDT
                            </div>
                            <div class="history-status ${statusClass}">
                                ${trade.result === 'won' ? 'ç›ˆåˆ©' : 'äºæŸ'}
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            renderTopics();
            
            // æ£€æŸ¥URLå‚æ•°
            const urlParams = new URLSearchParams(window.location.search);
            const topicId = urlParams.get('topic');
            if (topicId) {
                showTopicDetail(parseInt(topicId));
            }
        });
    </script>
</body>
</html>

